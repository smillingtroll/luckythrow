<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Duck Crash - Telegram Game</title>
    <style>
        /* === –û–°–ù–û–í–ù–´–ï –°–¢–ò–õ–ò === */
        :root {
            --primary-green: #00ff88;
            --dark-green: #006633;
            --lava-red: #ff4400;
            --lava-orange: #ff8800;
            --dark-bg: #0a0a0a;
            --darker-bg: #050505;
            --card-bg: rgba(0, 255, 136, 0.05);
            --border-color: rgba(0, 255, 136, 0.2);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
            --success: #00ff88;
            --error: #ff4444;
            --warning: #ffaa00;
            --info: #4488ff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-font-smoothing: antialiased;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--dark-bg);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
            position: fixed;
            width: 100%;
            background-image: 
                linear-gradient(rgba(0, 255, 136, 0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 136, 0.02) 1px, transparent 1px);
            background-size: 30px 30px;
        }

        /* === –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† === */
        #app {
            height: 100vh;
            display: flex;
            flex-direction: column;
            max-width: 480px;
            margin: 0 auto;
            position: relative;
        }

        /* === –®–ê–ü–ö–ê === */
        .header {
            padding: 12px 16px;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(0, 255, 136, 0.1);
            flex-shrink: 0;
            z-index: 100;
        }

        .balance-container {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(0, 255, 136, 0.1);
            padding: 6px 12px;
            border-radius: 12px;
            border: 1px solid rgba(0, 255, 136, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .balance-container:hover {
            background: rgba(0, 255, 136, 0.15);
            transform: translateY(-1px);
        }

        .wallet-icon {
            font-size: 18px;
        }

        #balance {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary-green);
            font-variant-numeric: tabular-nums;
        }

        .currency {
            font-size: 12px;
            color: var(--text-secondary);
            opacity: 0.8;
        }

        .user-info-container {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 4px;
        }

        .user-id {
            background: rgba(255, 255, 255, 0.05);
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 11px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .username {
            font-size: 12px;
            color: var(--primary-green);
            font-weight: 500;
        }

        /* === –ú–ï–ù–Æ –ö–û–®–ï–õ–¨–ö–ê === */
        .wallet-menu {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(5, 5, 5, 0.98);
            z-index: 1000;
            padding: 20px;
            overflow-y: auto;
            display: none;
            animation: slideIn 0.3s ease;
        }

        .wallet-menu.active {
            display: block;
        }

        .wallet-menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .wallet-menu-header h3 {
            color: var(--primary-green);
            font-size: 20px;
        }

        .close-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 28px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .wallet-info {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .wallet-status {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 16px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--error);
        }

        .status-dot.connected {
            background: var(--success);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .wallet-address {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            padding: 12px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            word-break: break-all;
            border: 1px solid rgba(255, 255, 255, 0.05);
            cursor: pointer;
            transition: all 0.3s;
        }

        .wallet-address:hover {
            background: rgba(0, 0, 0, 0.5);
        }

        .connect-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, var(--primary-green), var(--dark-green));
            border: none;
            border-radius: 12px;
            color: black;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 16px;
        }

        .connect-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 136, 0.3);
        }

        .deposit-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .deposit-section h4 {
            margin-bottom: 16px;
            color: var(--primary-green);
            font-size: 16px;
        }

        .deposit-amount {
            display: flex;
            gap: 10px;
            margin-bottom: 16px;
        }

        .deposit-amount input {
            flex: 1;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            font-size: 16px;
            font-variant-numeric: tabular-nums;
        }

        .deposit-amount button {
            padding: 12px 20px;
            background: linear-gradient(135deg, var(--lava-orange), var(--lava-red));
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s;
        }

        .deposit-amount button:hover {
            transform: translateY(-2px);
        }

        .deposit-info {
            background: rgba(0, 0, 0, 0.3);
            padding: 16px;
            border-radius: 12px;
            margin-top: 16px;
            border: 1px solid rgba(255, 68, 0, 0.2);
        }

        .deposit-address {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            padding: 12px;
            background: rgba(255, 68, 0, 0.1);
            border-radius: 8px;
            margin: 12px 0;
            border: 1px solid rgba(255, 68, 0, 0.3);
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .deposit-address:hover {
            background: rgba(255, 68, 0, 0.15);
        }

        .copy-icon {
            opacity: 0.7;
            transition: opacity 0.3s;
        }

        .deposit-address:hover .copy-icon {
            opacity: 1;
        }

        .deposit-hint {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 12px;
            opacity: 0.8;
        }

        /* === –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ === */
        .content {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            position: relative;
            -webkit-overflow-scrolling: touch;
        }

        .section {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .section.active {
            display: block;
        }

        /* === –õ–û–ë–ë–ò –ò–ì–† === */
        .lobby-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .lobby-header h1 {
            font-size: 32px;
            background: linear-gradient(135deg, var(--primary-green), var(--lava-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
            font-weight: 800;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 14px;
            opacity: 0.8;
        }

        .games-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 32px;
        }

        .game-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 24px 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }

        .game-card:hover {
            transform: translateY(-4px);
            border-color: var(--primary-green);
            box-shadow: 0 10px 30px rgba(0, 255, 136, 0.15);
        }

        .game-card-icon {
            font-size: 48px;
            margin-bottom: 16px;
            transition: transform 0.3s;
        }

        .game-card:hover .game-card-icon {
            transform: scale(1.1);
        }

        .dice-icon {
            animation: diceFloat 3s ease-in-out infinite;
        }

        .crash-icon {
            animation: boatFloat 3s ease-in-out infinite;
        }

        @keyframes diceFloat {
            0%, 100% { transform: rotate(0deg) translateY(0); }
            50% { transform: rotate(5deg) translateY(-5px); }
        }

        @keyframes boatFloat {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-5px) rotate(2deg); }
        }

        .game-card-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--primary-green);
        }

        .game-card-desc {
            font-size: 12px;
            color: var(--text-secondary);
            opacity: 0.8;
        }

        /* === –ò–ì–†–ê –í –ö–û–°–¢–ò === */
        .game-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .back-button {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s;
        }

        .back-button:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(-2px);
        }

        .game-title {
            font-size: 22px;
            font-weight: 600;
            color: var(--primary-green);
        }

        .multiplier-badge {
            background: linear-gradient(135deg, var(--primary-green), var(--dark-green));
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫—É–±–∏–∫–∞ */
        .dice-container {
            position: relative;
            margin-bottom: 24px;
        }

        .dice-display {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 24px;
            padding: 40px 20px;
            text-align: center;
            border: 2px solid rgba(0, 255, 136, 0.1);
            position: relative;
            overflow: hidden;
        }

        .dice-display::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, transparent, var(--primary-green), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .dice-result {
            font-size: 80px;
            font-weight: 800;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary-green), var(--lava-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 16px;
        }

        .dice-status {
            font-size: 16px;
            color: var(--text-secondary);
            opacity: 0.8;
        }

        /* –¢–∞–π–º–µ—Ä –±—Ä–æ—Å–∫–∞ */
        .roll-timer {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
        }

        .timer-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .timer-circle::before {
            content: '';
            position: absolute;
            width: 110px;
            height: 110px;
            border: 3px solid var(--primary-green);
            border-radius: 50%;
            animation: pulse-ring 1s infinite;
        }

        @keyframes pulse-ring {
            0% { transform: scale(0.9); opacity: 1; }
            100% { transform: scale(1.1); opacity: 0; }
        }

        .timer-text {
            font-size: 32px;
            font-weight: 600;
            color: var(--primary-green);
        }

        /* –ö–Ω–æ–ø–∫–∞ –∏–≥—Ä—ã */
        .play-button {
            width: 100%;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary-green), var(--dark-green));
            border: none;
            border-radius: 16px;
            color: black;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 24px;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .play-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 255, 136, 0.3);
        }

        .play-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .button-text {
            font-size: 18px;
        }

        .button-subtext {
            font-size: 14px;
            opacity: 0.9;
        }

        /* –í—ã–±–æ—Ä —Ç–∏–ø–∞ —Å—Ç–∞–≤–∫–∏ */
        .bet-section {
            margin-bottom: 24px;
        }

        .section-title {
            font-size: 14px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
            opacity: 0.7;
        }

        .bet-types {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .bet-type-card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .bet-type-card:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .bet-type-card.selected {
            background: rgba(0, 255, 136, 0.1);
            border-color: var(--primary-green);
            box-shadow: 0 5px 15px rgba(0, 255, 136, 0.2);
        }

        .bet-type-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .bet-type-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--primary-green);
        }

        .bet-type-multiplier {
            font-size: 16px;
            font-weight: 700;
            color: var(--primary-green);
        }

        .bet-type-desc {
            font-size: 12px;
            color: var(--text-secondary);
            opacity: 0.8;
        }

        /* –í—ã–±–æ—Ä —á–∏—Å–µ–ª */
        .numbers-section {
            margin-bottom: 24px;
        }

        .numbers-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .number-circle {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            font-size: 24px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .number-circle:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.05);
        }

        .number-circle.selected {
            background: linear-gradient(135deg, var(--primary-green), var(--dark-green));
            color: black;
            border-color: var(--primary-green);
            box-shadow: 0 5px 15px rgba(0, 255, 136, 0.3);
        }

        /* –°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏ */
        .amount-section {
            margin-bottom: 32px;
        }

        .amount-controls {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .amount-input-container {
            position: relative;
        }

        .amount-input {
            width: 100%;
            padding: 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            font-size: 18px;
            text-align: center;
            font-variant-numeric: tabular-nums;
        }

        .amount-input:focus {
            outline: none;
            border-color: var(--primary-green);
            background: rgba(0, 255, 136, 0.05);
        }

        .amount-currency {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            font-size: 14px;
        }

        .quick-amounts {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 8px;
        }

        .quick-amount {
            padding: 10px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .quick-amount:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        /* === –ò–ì–†–ê –ö–†–ê–® === */
        .crash-game-container {
            position: relative;
            margin-bottom: 24px;
        }

        .crash-visual {
            position: relative;
            height: 250px;
            background: linear-gradient(to bottom, rgba(5, 5, 5, 0.9), rgba(255, 68, 0, 0.1));
            border-radius: 24px;
            overflow: hidden;
            border: 2px solid rgba(255, 68, 0, 0.2);
            margin-bottom: 20px;
        }

        /* –õ–∞–≤–∞ */
        .lava-background {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: linear-gradient(to top, 
                var(--lava-red) 0%,
                var(--lava-orange) 30%,
                rgba(255, 136, 0, 0.8) 70%,
                rgba(255, 68, 0, 0.3) 100%);
            animation: lavaFlow 3s infinite alternate;
            z-index: 1;
        }

        @keyframes lavaFlow {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(20deg); }
        }

        .lava-wave {
            position: absolute;
            bottom: 60px;
            left: 0;
            right: 0;
            height: 40px;
            background: linear-gradient(to top, 
                rgba(255, 68, 0, 0.4) 0%,
                rgba(255, 136, 0, 0.6) 50%,
                rgba(255, 68, 0, 0.2) 100%);
            border-radius: 50% 50% 0 0;
            animation: waveMove 4s ease-in-out infinite;
            z-index: 2;
        }

        @keyframes waveMove {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .lava-bubbles {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100px;
            z-index: 3;
        }

        .bubble {
            position: absolute;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            bottom: 0;
            animation: bubbleRise 3s infinite;
        }

        .bubble:nth-child(1) {
            width: 15px;
            height: 15px;
            left: 20%;
            animation-delay: 0s;
        }

        .bubble:nth-child(2) {
            width: 20px;
            height: 20px;
            left: 50%;
            animation-delay: 1s;
        }

        .bubble:nth-child(3) {
            width: 12px;
            height: 12px;
            left: 80%;
            animation-delay: 2s;
        }

        @keyframes bubbleRise {
            0% {
                bottom: 0;
                opacity: 1;
                transform: scale(0.5);
            }
            100% {
                bottom: 100%;
                opacity: 0;
                transform: scale(1.5);
            }
        }

        /* –£—Ç–∫–∞ */
        .duck-container {
            position: absolute;
            left: 20%;
            bottom: 60px;
            transition: all 0.05s linear;
            z-index: 4;
            transform-origin: bottom center;
        }

        .duck {
            position: relative;
            transition: transform 0.3s;
        }

        .duck-body {
            font-size: 48px;
            position: relative;
            z-index: 2;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5));
            transition: transform 0.2s;
        }

        .duck-boat {
            font-size: 64px;
            position: absolute;
            left: -12px;
            bottom: -24px;
            z-index: 1;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.5));
        }

        .duck.crashed .duck-body {
            content: "üçó";
            animation: burn 0.5s forwards;
        }

        @keyframes burn {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0) rotate(360deg); opacity: 0; }
        }

        .duck-shadow {
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 12px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 50%;
            filter: blur(4px);
            z-index: 1;
        }

        /* –ú—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–æ—Ä */
        .multiplier-display {
            text-align: center;
            margin-bottom: 20px;
        }

        .multiplier-label {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .multiplier-value {
            font-size: 48px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary-green), var(--lava-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 12px;
            font-variant-numeric: tabular-nums;
        }

        .multiplier-progress {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            position: relative;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-green), var(--lava-orange));
            width: 0%;
            transition: width 0.1s linear;
            position: relative;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.3), 
                transparent);
            animation: progressShimmer 2s infinite;
        }

        @keyframes progressShimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* –ò—Å—Ç–æ—Ä–∏—è –º—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–æ—Ä–æ–≤ */
        .multiplier-history {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 24px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .history-title {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 12px;
            text-align: center;
        }

        .history-list {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 8px;
        }

        .history-item {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            min-width: 60px;
            text-align: center;
            flex-shrink: 0;
        }

        .history-item.win {
            background: rgba(0, 255, 136, 0.1);
            color: var(--primary-green);
            border: 1px solid rgba(0, 255, 136, 0.3);
        }

        .history-item.loss {
            background: rgba(255, 68, 0, 0.1);
            color: var(--lava-red);
            border: 1px solid rgba(255, 68, 0, 0.3);
        }

        /* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–π –∫—Ä–∞—à */
        .crash-controls {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .bet-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .bet-amount-info, .potential-win {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .bet-amount-info span:first-child,
        .potential-win span:first-child {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .bet-amount-info span:last-child {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary-green);
        }

        .potential-win span:last-child {
            font-size: 18px;
            font-weight: 600;
            color: var(--lava-orange);
        }

        .control-buttons {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
        }

        .control-btn {
            flex: 1;
            padding: 20px;
            border: none;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .bet-btn {
            background: linear-gradient(135deg, var(--primary-green), var(--dark-green));
            color: black;
        }

        .cashout-btn {
            background: linear-gradient(135deg, var(--lava-orange), var(--lava-red));
            color: white;
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 255, 136, 0.3);
        }

        .cashout-btn:hover {
            box-shadow: 0 8px 25px rgba(255, 68, 0, 0.3);
        }

        .btn-text {
            font-size: 16px;
        }

        .btn-subtext {
            font-size: 12px;
            opacity: 0.9;
        }

        /* –í—ã–±–æ—Ä —Å—É–º–º—ã —Å—Ç–∞–≤–∫–∏ –¥–ª—è –∫—Ä–∞—à–∞ */
        .crash-bet-amount {
            margin-bottom: 20px;
        }

        .amount-slider {
            margin-bottom: 16px;
        }

        .amount-slider input[type="range"] {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }

        .amount-slider input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            background: var(--primary-green);
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid black;
            box-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .amount-input-crash {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .amount-input-crash input {
            flex: 1;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            font-size: 16px;
            text-align: center;
            font-variant-numeric: tabular-nums;
        }

        .amount-input-crash span {
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* –°–∫–æ—Ä–æ—Å—Ç—å –Ω–∞–±–æ—Ä–∞ */
        .speed-display {
            margin-top: 12px;
            padding: 10px;
            background: rgba(0, 255, 136, 0.05);
            border-radius: 8px;
            text-align: center;
        }

        .speed-label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        .speed-value {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary-green);
        }

        /* –®–∞–Ω—Å—ã –Ω–∞ –ø–æ–±–µ–¥—É */
        .odds-section {
            margin-top: 24px;
        }

        .odds-title {
            font-size: 14px;
            color: var(--text-secondary);
            text-align: center;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .odds-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
        }

        .odd-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 12px 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .odd-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .odd-multiplier {
            font-size: 12px;
            font-weight: 600;
            color: var(--primary-green);
            margin-bottom: 4px;
        }

        .odd-chance {
            font-size: 10px;
            color: var(--text-secondary);
            opacity: 0.8;
        }

        /* === –ú–ï–ù–Æ === */
        .menu-header {
            margin-bottom: 24px;
        }

        .menu-content {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .menu-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .menu-section-title {
            font-size: 16px;
            color: var(--primary-green);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .profile-info {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .profile-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .profile-item:last-child {
            border-bottom: none;
        }

        .profile-label {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .profile-value {
            font-size: 14px;
            font-weight: 600;
            color: var(--primary-green);
            max-width: 150px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-item:last-child {
            border-bottom: none;
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .stat-value {
            font-size: 14px;
            font-weight: 600;
            color: var(--primary-green);
        }

        /* –ü—Ä–æ–º–æ–∫–æ–¥ */
        .promo-input-container {
            display: flex;
            gap: 10px;
            margin-bottom: 12px;
        }

        .promo-input {
            flex: 1;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            font-size: 14px;
        }

        .promo-btn {
            padding: 12px 20px;
            background: linear-gradient(135deg, var(--primary-green), var(--dark-green));
            border: none;
            border-radius: 12px;
            color: black;
            font-weight: 600;
            cursor: pointer;
            white-space: nowrap;
        }

        .promo-result {
            padding: 10px;
            border-radius: 8px;
            font-size: 13px;
            text-align: center;
            display: none;
        }

        .promo-result.success {
            background: rgba(0, 255, 136, 0.1);
            color: var(--primary-green);
            border: 1px solid rgba(0, 255, 136, 0.2);
            display: block;
        }

        .promo-result.error {
            background: rgba(255, 68, 0, 0.1);
            color: var(--lava-red);
            border: 1px solid rgba(255, 68, 0, 0.2);
            display: block;
        }

        /* –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å */
        .admin-input-container {
            display: flex;
            gap: 10px;
            margin-bottom: 12px;
        }

        .admin-input {
            flex: 1;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            font-size: 14px;
        }

        .admin-btn {
            padding: 12px 20px;
            background: linear-gradient(135deg, var(--lava-orange), var(--lava-red));
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            white-space: nowrap;
        }

        .admin-panel {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: none;
        }

        .admin-panel.show {
            display: block;
        }

        .admin-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .admin-action-btn {
            padding: 14px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-action-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        /* –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤ */
        .withdraw-container {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .withdraw-info {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .withdraw-input-container {
            display: flex;
            gap: 10px;
        }

        .withdraw-input {
            flex: 1;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            font-size: 14px;
        }

        .withdraw-btn {
            padding: 12px 20px;
            background: linear-gradient(135deg, var(--primary-green), var(--dark-green));
            border: none;
            border-radius: 12px;
            color: black;
            font-weight: 600;
            cursor: pointer;
            white-space: nowrap;
        }

        .withdraw-result {
            padding: 10px;
            border-radius: 8px;
            font-size: 13px;
            text-align: center;
            display: none;
        }

        .withdraw-result.show {
            display: block;
        }

        .withdraw-result.success {
            background: rgba(0, 255, 136, 0.1);
            color: var(--primary-green);
            border: 1px solid rgba(0, 255, 136, 0.2);
        }

        .withdraw-result.pending {
            background: rgba(255, 170, 0, 0.1);
            color: var(--warning);
            border: 1px solid rgba(255, 170, 0, 0.2);
        }

        .withdraw-result.error {
            background: rgba(255, 68, 0, 0.1);
            color: var(--lava-red);
            border: 1px solid rgba(255, 68, 0, 0.2);
        }

        /* –ö–æ–Ω—Ç–∞–∫—Ç—ã */
        .contact-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
        }

        .contact-label {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .contact-link {
            color: var(--primary-green);
            text-decoration: none;
            font-size: 14px;
        }

        .contact-link:hover {
            text-decoration: underline;
        }

        /* === SUPABASE STYLES === */
        /* –°—Ç–∏–ª–∏ –¥–ª—è Supabase –∫–Ω–æ–ø–æ–∫ */
        .supabase-btn {
            position: relative;
            border: 1px solid rgba(0, 255, 136, 0.3) !important;
        }

        .supabase-btn small {
            position: absolute;
            top: 4px;
            right: 8px;
            font-size: 9px;
            color: var(--primary-green);
            opacity: 0.7;
        }

        .supabase-btn:hover {
            background: rgba(0, 255, 136, 0.15) !important;
            border-color: var(--primary-green) !important;
        }

        .supabase-btn:hover small {
            opacity: 1;
        }

        /* –°—Ç–∞—Ç—É—Å Supabase */
        .supabase-status {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            margin-top: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .supabase-status .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #ff4444;
        }

        .supabase-status .status-dot.connected {
            background: #00ff88;
            animation: pulse 2s infinite;
        }

        .supabase-status .status-dot.error {
            background: #ff4444;
        }

        .supabase-status .status-text {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin: 20px 0;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            border: 1px solid rgba(0, 255, 136, 0.1);
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-green);
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .stats-date {
            text-align: center;
            margin: 15px 0;
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* –ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π */
        .history-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .history-action {
            font-weight: 600;
            color: var(--primary-green);
            font-size: 14px;
        }

        .history-time {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .history-admin {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .history-details {
            font-size: 12px;
            color: var(--text-secondary);
            background: rgba(0, 0, 0, 0.3);
            padding: 8px;
            border-radius: 6px;
            font-family: monospace;
            word-break: break-all;
        }

        /* === –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê === */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(5, 5, 5, 0.95);
            z-index: 1000;
            display: none;
            animation: fadeIn 0.3s;
        }

        .modal-overlay.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background: rgba(10, 10, 10, 0.95);
            border-radius: 24px;
            padding: 24px;
            width: 100%;
            max-width: 400px;
            border: 1px solid rgba(0, 255, 136, 0.2);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .wide-modal {
            max-width: 500px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-header h3 {
            font-size: 20px;
            color: var(--primary-green);
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 28px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        /* –ü–æ–∏—Å–∫ –≤ —Å–ø–∏—Å–∫–µ –∏–≥—Ä–æ–∫–æ–≤ */
        .search-container {
            margin-bottom: 20px;
        }

        .search-input {
            width: 100%;
            padding: 14px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            font-size: 16px;
        }

        .players-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-height: 400px;
            overflow-y: auto;
        }

        .player-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s;
        }

        .player-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .player-info {
            margin-bottom: 12px;
        }

        .player-username {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .player-id {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        .player-wallet {
            font-family: 'Courier New', monospace;
            font-size: 11px;
            color: var(--text-secondary);
            word-break: break-all;
        }

        .player-balance {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 12px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .balance-label {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .balance-value {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary-green);
        }

        .balance-edit {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }

        .balance-edit input {
            flex: 1;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: white;
            font-size: 14px;
        }

        .balance-edit button {
            padding: 8px 16px;
            background: linear-gradient(135deg, var(--primary-green), var(--dark-green));
            border: none;
            border-radius: 8px;
            color: black;
            font-weight: 600;
            cursor: pointer;
        }

        /* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à–∞–Ω—Å–∞–º–∏ */
        .odds-control-container {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .game-odds-selector {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
        }

        .game-odds-tab {
            flex: 1;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: var(--text-secondary);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .game-odds-tab.active {
            background: rgba(0, 255, 136, 0.1);
            color: var(--primary-green);
            border-color: var(--primary-green);
        }

        .odds-controls {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .odds-control-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .odds-control-item:last-child {
            border-bottom: none;
        }

        .odds-control-label {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .odds-control-input {
            width: 100px;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: white;
            font-size: 14px;
            text-align: center;
        }

        .odds-control-input:focus {
            outline: none;
            border-color: var(--primary-green);
        }

        /* –í—ã–≤–æ–¥—ã –∞–¥–º–∏–Ω–∞ */
        .withdraw-admin-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-height: 400px;
            overflow-y: auto;
        }

        .withdraw-admin-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .withdraw-user-info {
            margin-bottom: 12px;
        }

        .withdraw-username {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .withdraw-user-id {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        .withdraw-wallet {
            font-family: 'Courier New', monospace;
            font-size: 11px;
            color: var(--text-secondary);
            word-break: break-all;
            padding: 8px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .withdraw-wallet:hover {
            background: rgba(0, 0, 0, 0.5);
        }

        .withdraw-amount {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .amount-label {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .amount-value {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary-green);
        }

        .withdraw-actions {
            display: flex;
            gap: 8px;
        }

        .withdraw-action-btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .withdraw-approve {
            background: rgba(0, 255, 136, 0.1);
            color: var(--primary-green);
            border: 1px solid rgba(0, 255, 136, 0.3);
        }

        .withdraw-approve:hover {
            background: rgba(0, 255, 136, 0.2);
            transform: translateY(-2px);
        }

        .withdraw-reject {
            background: rgba(255, 68, 0, 0.1);
            color: var(--lava-red);
            border: 1px solid rgba(255, 68, 0, 0.3);
        }

        .withdraw-reject:hover {
            background: rgba(255, 68, 0, 0.2);
            transform: translateY(-2px);
        }

        /* === –ù–ò–ñ–ù–Ø–Ø –ù–ê–í–ò–ì–ê–¶–ò–Ø === */
        .bottom-nav {
            display: flex;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(0, 255, 136, 0.1);
            padding: 12px;
            flex-shrink: 0;
        }

        .nav-btn {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 8px;
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 12px;
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .nav-btn.active {
            color: var(--primary-green);
            background: rgba(0, 255, 136, 0.1);
        }

        .nav-icon {
            font-size: 20px;
            margin-bottom: 4px;
        }

        .nav-label {
            font-size: 11px;
            font-weight: 500;
        }

        /* === –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø === */
        .notification {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid var(--primary-green);
            border-radius: 12px;
            padding: 16px 24px;
            color: white;
            font-size: 14px;
            z-index: 10000;
            display: none;
            animation: slideUp 0.3s ease;
            max-width: 90%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .notification.active {
            display: block;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translate(-50%, 20px);
            }
            to {
                opacity: 1;
                transform: translate(-50%, 0);
            }
        }

        /* === –£–¢–ò–õ–ò–¢–´ === */
        .hidden {
            display: none !important;
        }

        .show {
            display: block !important;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* === –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ === */
        @media (max-width: 480px) {
            .content {
                padding: 12px;
            }
            
            .game-card {
                padding: 20px 12px;
            }
            
            .dice-result {
                font-size: 60px;
                height: 80px;
            }
            
            .multiplier-value {
                font-size: 36px;
            }
            
            .control-btn {
                padding: 16px;
            }
            
            .modal-content {
                padding: 20px;
            }
        }

        /* –°–∫—Ä–æ–ª–ª–±–∞—Ä */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(0, 255, 136, 0.3);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 255, 136, 0.5);
        }
    </style>
</head>
<body>
    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
    <div id="app">
        <!-- –®–∞–ø–∫–∞ -->
        <header class="header">
            <div class="balance-container" onclick="showWalletMenu()">
                <span class="wallet-icon">üëõ</span>
                <span id="balance">0.00</span>
                <span class="currency">TON</span>
            </div>
            <div class="user-info-container">
                <div class="username" id="username">–ì–æ—Å—Ç—å</div>
                <div class="user-id" id="user-id">ID: 0000</div>
            </div>
        </header>

        <!-- –ú–µ–Ω—é –∫–æ—à–µ–ª—å–∫–∞ -->
        <div id="wallet-menu" class="wallet-menu">
            <div class="wallet-menu-header">
                <h3>–ö–æ—à–µ–ª–µ–∫ TON</h3>
                <button class="close-btn" onclick="hideWalletMenu()">√ó</button>
            </div>
            <div class="wallet-menu-body">
                <div class="wallet-info">
                    <div class="wallet-status">
                        <div class="status-dot" id="wallet-status-dot"></div>
                        <span id="wallet-status-text">–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω</span>
                    </div>
                    <div class="wallet-address" id="wallet-address" onclick="copyToClipboard(this)">–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫</div>
                    <button class="connect-btn" onclick="connectWallet()">–ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª–µ–∫</button>
                </div>
                
                <div class="deposit-section">
                    <h4>–ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å</h4>
                    <div class="deposit-amount">
                        <input type="number" id="deposit-amount" value="1" min="0.1" step="0.1" placeholder="–°—É–º–º–∞ –≤ TON">
                        <button onclick="generateDeposit()">–ü–æ–ø–æ–ª–Ω–∏—Ç—å</button>
                    </div>
                    <div id="deposit-info" class="deposit-info hidden">
                        <p>–û—Ç–ø—Ä–∞–≤—å—Ç–µ <span id="deposit-ton">1</span> TON –Ω–∞ –∞–¥—Ä–µ—Å:</p>
                        <div class="deposit-address" onclick="copyDepositAddress()">
                            <span id="deposit-address">UQAthS8QDwBDsbohkCxqfL22NS4NrtV9QMC1jBj78bb-4pVe</span>
                            <span class="copy-icon">üìã</span>
                        </div>
                        <p class="deposit-hint">–ë–∞–ª–∞–Ω—Å –æ–±–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <main id="content" class="content">
            <!-- –õ–æ–±–±–∏ –∏–≥—Ä -->
            <div id="games-section" class="section active">
                <div class="lobby-header">
                    <h1>üî• DUCK CRASH</h1>
                    <p class="subtitle">–£—Ç–∫–∞ –≤ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ - —Å–ø–∞—Å–∏ –µ—ë!</p>
                </div>
                
                <div class="games-grid">
                    <div class="game-card" onclick="showDiceGame()">
                        <div class="game-card-icon dice-icon">üé≤</div>
                        <div class="game-card-name">–ö–£–ë–´</div>
                        <div class="game-card-desc">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∏–≥—Ä–∞ –≤ –∫–æ—Å—Ç–∏</div>
                    </div>
                    
                    <div class="game-card" onclick="showCrashGame()">
                        <div class="game-card-icon crash-icon">üõ∂</div>
                        <div class="game-card-name">–ö–†–ê–®</div>
                        <div class="game-card-desc">–£—Ç–∫–∞ –Ω–∞ –ª–∞–≤–µ - –ª–æ–≤–∏ –º–æ–º–µ–Ω—Ç!</div>
                    </div>
                </div>
            </div>

            <!-- –ò–≥—Ä–∞ –≤ –∫–æ—Å—Ç–∏ -->
            <div id="dice-section" class="section">
                <div class="game-header">
                    <button class="back-button" onclick="showGamesSection()">‚Üê –ù–∞–∑–∞–¥</button>
                    <h2 class="game-title">üé≤ –ò–ì–†–ê –í –ö–£–ë–´</h2>
                    <div class="game-header-right">
                        <span class="multiplier-badge" id="dice-multiplier">3x</span>
                    </div>
                </div>
                
                <div class="dice-container">
                    <div class="dice-display">
                        <div id="dice-result" class="dice-result">?</div>
                        <div id="dice-status" class="dice-status">–°–¥–µ–ª–∞–π—Ç–µ —Å—Ç–∞–≤–∫—É</div>
                    </div>
                    <div class="roll-timer hidden" id="roll-timer">
                        <div class="timer-circle">
                            <span class="timer-text">3</span>
                        </div>
                    </div>
                </div>

                <button id="play-button" class="play-button" onclick="startDiceGame()" disabled>
                    <span class="button-text">–ö–†–£–¢–ò–¢–¨ –ö–£–ë</span>
                    <span class="button-subtext" id="potential-win">–í—ã–∏–≥—Ä—ã—à: 0 TON</span>
                </button>

                <div class="bet-section">
                    <div class="section-title">–¢–ò–ü –°–¢–ê–í–ö–ò</div>
                    <div class="bet-types">
                        <div class="bet-type-card" onclick="selectBetType('single')">
                            <div class="bet-type-header">
                                <div class="bet-type-name">1 –ß–ò–°–õ–û</div>
                                <div class="bet-type-multiplier">3x</div>
                            </div>
                            <div class="bet-type-desc">–£–≥–∞–¥–∞–π—Ç–µ –æ–¥–Ω–æ —á–∏—Å–ª–æ</div>
                        </div>
                        
                        <div class="bet-type-card" onclick="selectBetType('double')">
                            <div class="bet-type-header">
                                <div class="bet-type-name">2 –ß–ò–°–õ–ê</div>
                                <div class="bet-type-multiplier">1.5x</div>
                            </div>
                            <div class="bet-type-desc">–£–≥–∞–¥–∞–π—Ç–µ –¥–≤–∞ —á–∏—Å–ª–∞</div>
                        </div>
                        
                        <div class="bet-type-card" onclick="selectBetType('triple')">
                            <div class="bet-type-header">
                                <div class="bet-type-name">3 –ß–ò–°–õ–ê</div>
                                <div class="bet-type-multiplier">1.25x</div>
                            </div>
                            <div class="bet-type-desc">–£–≥–∞–¥–∞–π—Ç–µ —Ç—Ä–∏ —á–∏—Å–ª–∞</div>
                        </div>
                    </div>
                </div>

                <div class="numbers-section">
                    <div class="section-title">–í–´–ë–ï–†–ò–¢–ï –ß–ò–°–õ–ê</div>
                    <div class="numbers-grid">
                        <div class="number-circle" onclick="toggleNumber(1)">1</div>
                        <div class="number-circle" onclick="toggleNumber(2)">2</div>
                        <div class="number-circle" onclick="toggleNumber(3)">3</div>
                        <div class="number-circle" onclick="toggleNumber(4)">4</div>
                        <div class="number-circle" onclick="toggleNumber(5)">5</div>
                        <div class="number-circle" onclick="toggleNumber(6)">6</div>
                    </div>
                </div>

                <div class="amount-section">
                    <div class="section-title">–°–£–ú–ú–ê –°–¢–ê–í–ö–ò (TON)</div>
                    <div class="amount-controls">
                        <div class="amount-input-container">
                            <input type="number" id="dice-bet-amount" class="amount-input" value="0.1" min="0.1" step="0.1" onchange="updateDiceBetAmount()">
                            <span class="amount-currency">TON</span>
                        </div>
                        <div class="quick-amounts">
                            <button class="quick-amount" onclick="setQuickAmount(0.1)">0.1</button>
                            <button class="quick-amount" onclick="setQuickAmount(0.5)">0.5</button>
                            <button class="quick-amount" onclick="setQuickAmount(1)">1</button>
                            <button class="quick-amount" onclick="setQuickAmount(5)">5</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ò–≥—Ä–∞ –ö–†–ê–® -->
            <div id="crash-section" class="section">
                <div class="game-header">
                    <button class="back-button" onclick="showGamesSection()">‚Üê –ù–∞–∑–∞–¥</button>
                    <h2 class="game-title">üõ∂ DUCK CRASH</h2>
                    <div class="game-header-right">
                        <div class="last-multiplier">–ü–æ—Å–ª–µ–¥–Ω–∏–π: <span id="last-multiplier">1.63x</span></div>
                    </div>
                </div>

                <div class="crash-game-container">
                    <div class="crash-visual">
                        <div class="lava-background" id="lava-background">
                            <div class="lava-wave"></div>
                            <div class="lava-bubbles">
                                <div class="bubble"></div>
                                <div class="bubble"></div>
                                <div class="bubble"></div>
                            </div>
                        </div>
                        
                        <div class="duck-container" id="duck-container">
                            <div class="duck" id="duck">
                                <div class="duck-body">ü¶Ü</div>
                                <div class="duck-boat">üõ∂</div>
                            </div>
                            <div class="duck-shadow"></div>
                        </div>
                    </div>

                    <div class="multiplier-display">
                        <div class="multiplier-label">–ú–£–õ–¨–¢–ò–ü–õ–ò–ö–ê–¢–û–†</div>
                        <div class="multiplier-value" id="current-multiplier">1.00x</div>
                        <div class="speed-display hidden" id="speed-display">
                            <div class="speed-label">–°–ö–û–†–û–°–¢–¨ –ù–ê–ë–û–†–ê</div>
                            <div class="speed-value" id="speed-value">0x/—Å–µ–∫</div>
                        </div>
                    </div>

                    <div class="multiplier-history">
                        <div class="history-title">–ò–°–¢–û–†–ò–Ø –ò–ì–†</div>
                        <div class="history-list" id="multiplier-history">
                            <div class="history-item win">2.15x</div>
                            <div class="history-item loss">1.08x</div>
                            <div class="history-item win">4.78x</div>
                            <div class="history-item win">1.45x</div>
                        </div>
                    </div>
                </div>

                <div class="crash-controls">
                    <div class="bet-info">
                        <div class="bet-amount-info">
                            <span>–°—Ç–∞–≤–∫–∞:</span>
                            <span id="current-bet">0 TON</span>
                        </div>
                        <div class="potential-win">
                            <span>–í—ã–∏–≥—Ä—ã—à:</span>
                            <span id="potential-win-amount">0 TON</span>
                        </div>
                    </div>

                    <div class="control-buttons">
                        <button id="place-bet-btn" class="control-btn bet-btn" onclick="placeCrashBet()">
                            <span class="btn-text">–ü–û–°–¢–ê–í–ò–¢–¨</span>
                            <span class="btn-subtext" id="bet-amount-display">0.1 TON</span>
                        </button>
                        
                        <button id="cashout-btn" class="control-btn cashout-btn hidden" onclick="cashOut()">
                            <span class="btn-text">–ó–ê–ë–†–ê–¢–¨</span>
                            <span class="btn-subtext" id="cashout-multiplier">1.00x</span>
                        </button>
                    </div>

                    <div class="crash-bet-amount">
                        <div class="amount-slider">
                            <input type="range" id="crash-bet-slider" min="0.1" max="100" step="0.1" value="0.1" oninput="updateCrashBetAmount()">
                            <div class="slider-labels">
                                <span>0.1</span>
                                <span>50</span>
                                <span>100</span>
                            </div>
                        </div>
                        <div class="amount-input-crash">
                            <input type="number" id="crash-bet-input" value="0.1" min="0.1" step="0.1" onchange="updateCrashBetInput()">
                            <span>TON</span>
                        </div>
                    </div>

                    <div class="odds-section">
                        <div class="odds-title">–®–ê–ù–°–´ –ù–ê –ü–û–ë–ï–î–£</div>
                        <div class="odds-grid">
                            <div class="odd-item" onclick="setTargetMultiplier(1.34)">
                                <div class="odd-multiplier">1.34x</div>
                                <div class="odd-chance">44.9%</div>
                            </div>
                            <div class="odd-item" onclick="setTargetMultiplier(1.00)">
                                <div class="odd-multiplier">1.00x</div>
                                <div class="odd-chance">9%</div>
                            </div>
                            <div class="odd-item" onclick="setTargetMultiplier(1.53)">
                                <div class="odd-multiplier">1.53x</div>
                                <div class="odd-chance">18%</div>
                            </div>
                            <div class="odd-item" onclick="setTargetMultiplier(1.72)">
                                <div class="odd-multiplier">1.72x</div>
                                <div class="odd-chance">9%</div>
                            </div>
                            <div class="odd-item" onclick="setTargetMultiplier(1.99)">
                                <div class="odd-multiplier">1.99x</div>
                                <div class="odd-chance">5%</div>
                            </div>
                            <div class="odd-item" onclick="setTargetMultiplier(2.28)">
                                <div class="odd-multiplier">2.28x</div>
                                <div class="odd-chance">3%</div>
                            </div>
                            <div class="odd-item" onclick="setTargetMultiplier(5.47)">
                                <div class="odd-multiplier">5.47x</div>
                                <div class="odd-chance">1.5%</div>
                            </div>
                            <div class="odd-item" onclick="setTargetMultiplier(9.87)">
                                <div class="odd-multiplier">9.87x</div>
                                <div class="odd-chance">0.5%</div>
                            </div>
                            <div class="odd-item" onclick="setTargetMultiplier(15.67)">
                                <div class="odd-multiplier">15.67x</div>
                                <div class="odd-chance">0.1%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ú–µ–Ω—é -->
            <div id="menu-section" class="section">
                <div class="menu-header">
                    <button class="back-button" onclick="showGamesSection()">‚Üê –ù–∞–∑–∞–¥</button>
                    <h2>‚öôÔ∏è –ù–ê–°–¢–†–û–ô–ö–ò</h2>
                </div>

                <div class="menu-content">
                    <div class="menu-section">
                        <div class="menu-section-title">üë§ –ü–†–û–§–ò–õ–¨</div>
                        <div class="profile-info">
                            <div class="profile-item">
                                <div class="profile-label">–í–∞—à ID:</div>
                                <div class="profile-value" id="profile-id">0000</div>
                            </div>
                            <div class="profile-item">
                                <div class="profile-label">–Æ–∑–µ—Ä–Ω–µ–π–º:</div>
                                <div class="profile-value" id="profile-username">–ì–æ—Å—Ç—å</div>
                            </div>
                            <div class="profile-item">
                                <div class="profile-label">–ö–æ—à–µ–ª–µ–∫:</div>
                                <div class="profile-value" id="profile-wallet">–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω</div>
                            </div>
                            <div class="profile-item">
                                <div class="profile-label">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:</div>
                                <div class="profile-value" id="reg-date">–°–µ–≥–æ–¥–Ω—è</div>
                            </div>
                        </div>
                    </div>

                    <div class="menu-section">
                        <div class="menu-section-title">üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê</div>
                        <div class="profile-info">
                            <div class="stat-item">
                                <div class="stat-label">–ò–≥—Ä —Å—ã–≥—Ä–∞–Ω–æ:</div>
                                <div class="stat-value" id="games-played">0</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">–û–±—â–∏–π –æ–±–æ—Ä–æ—Ç:</div>
                                <div class="stat-value" id="total-turnover">0 TON</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">–ú–∞–∫—Å. –≤—ã–∏–≥—Ä—ã—à:</div>
                                <div class="stat-value" id="max-win">0 TON</div>
                            </div>
                        </div>
                    </div>

                    <div class="menu-section">
                        <div class="menu-section-title">üéÅ –ü–†–û–ú–û–ö–û–î</div>
                        <div class="promo-input-container">
                            <input type="text" id="promo-input" class="promo-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥">
                            <button class="promo-btn" onclick="activatePromoCode()">–ê–ö–¢–ò–í–ò–†–û–í–ê–¢–¨</button>
                        </div>
                        <div id="promo-result" class="promo-result"></div>
                    </div>

                    <!-- –û–ë–ù–û–í–õ–ï–ù–ù–´–ô –ë–õ–û–ö –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–ò -->
                    <div class="menu-section">
                        <div class="menu-section-title">üîß –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨</div>
                        <div class="admin-input-container">
                            <input type="text" id="admin-code-input" class="admin-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∞–¥–º–∏–Ω –∫–æ–¥">
                            <button class="admin-btn" onclick="activateAdmin()">–ê–ö–¢–ò–í–ò–†–û–í–ê–¢–¨</button>
                        </div>
                        
                        <div id="admin-panel" class="admin-panel">
                            <div class="admin-actions">
                                <!-- –°—Ç–∞—Ä—ã–µ –∫–Ω–æ–ø–∫–∏ -->
                                <button class="admin-action-btn" onclick="openPlayersList()">
                                    <span>üë•</span>
                                    <span>–°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤</span>
                                </button>
                                
                                <button class="admin-action-btn" onclick="openOddsControl()">
                                    <span>üé≤</span>
                                    <span>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à–∞–Ω—Å–∞–º–∏</span>
                                </button>
                                
                                <button class="admin-action-btn" onclick="openWithdrawRequestsAdmin()">
                                    <span>üí∞</span>
                                    <span>–í—ã–≤–æ–¥—ã —Å—Ä–µ–¥—Å—Ç–≤</span>
                                </button>
                                
                                <button class="admin-action-btn" onclick="openCreatePromoModal()">
                                    <span>üéÅ</span>
                                    <span>–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥</span>
                                </button>
                                
                                <!-- –ù–û–í–´–ï –ö–ù–û–ü–ö–ò SUPABASE -->
                                <button class="admin-action-btn supabase-btn" onclick="syncWithSupabase()">
                                    <span>üîÑ</span>
                                    <span>–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–≥—Ä–æ–∫–æ–≤</span>
                                    <small>Supabase</small>
                                </button>
                                
                                <button class="admin-action-btn supabase-btn" onclick="resetAllBalancesSupabase()">
                                    <span>üí∞</span>
                                    <span>–û–±–Ω—É–ª–∏—Ç—å –≤—Å–µ–º –±–∞–ª–∞–Ω—Å</span>
                                    <small>Supabase</small>
                                </button>
                                
                                <button class="admin-action-btn supabase-btn" onclick="viewGlobalStatsSupabase()">
                                    <span>üåç</span>
                                    <span>–ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
                                    <small>Supabase</small>
                                </button>
                                
                                <button class="admin-action-btn supabase-btn" onclick="viewAdminHistory()">
                                    <span>üìú</span>
                                    <span>–ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π</span>
                                    <small>Supabase</small>
                                </button>
                                
                                <button class="admin-action-btn supabase-btn" onclick="syncWithdrawalsSupabase()">
                                    <span>üí∏</span>
                                    <span>–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥—ã</span>
                                    <small>Supabase</small>
                                </button>
                                
                                <button class="admin-action-btn" id="toggle-maintenance-btn" onclick="toggleMaintenance()">
                                    <span>üîß</span>
                                    <span>–í—ã–∫–ª—é—á–∏—Ç—å –∏–≥—Ä—É</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="menu-section">
                        <div class="menu-section-title">üí∞ –í–´–í–û–î –°–†–ï–î–°–¢–í</div>
                        <div class="withdraw-container">
                            <div class="withdraw-info">
                                <div class="withdraw-min">–ú–∏–Ω. –≤—ã–≤–æ–¥: 5 TON</div>
                                <div class="withdraw-fee">–ö–æ–º–∏—Å—Å–∏—è: 0.1 TON</div>
                            </div>
                            <div class="withdraw-input-container">
                                <input type="number" id="withdraw-input" class="withdraw-input" value="5" min="5" step="0.1" placeholder="–°—É–º–º–∞">
                                <button class="withdraw-btn" onclick="requestWithdrawal()">–í–´–í–ï–°–¢–ò</button>
                            </div>
                            <div id="withdraw-result" class="withdraw-result"></div>
                        </div>
                    </div>

                    <div class="menu-section">
                        <div class="menu-section-title">üìû –ö–û–ù–¢–ê–ö–¢–´</div>
                        <div class="contact-item">
                            <div class="contact-label">–¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞:</div>
                            <a href="https://t.me/artem_shaveko" class="contact-link">@artem_shaveko</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å -->
            <div id="inventory-section" class="section">
                <div class="menu-header">
                    <button class="back-button" onclick="showGamesSection()">‚Üê –ù–∞–∑–∞–¥</button>
                    <h2>üéí –ò–ù–í–ï–ù–¢–ê–†–¨</h2>
                </div>

                <div class="inventory-content">
                    <div class="inventory-stats">
                        <div class="inv-stat">
                            <div class="inv-stat-value" id="total-items">0</div>
                            <div class="inv-stat-label">–í—Å–µ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤</div>
                        </div>
                        <div class="inv-stat">
                            <div class="inv-stat-value" id="unique-items">0</div>
                            <div class="inv-stat-label">–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö</div>
                        </div>
                    </div>

                    <div class="inventory-grid" id="inventory-items"></div>
                    <div class="empty-inventory" id="empty-inventory">üéÅ –í–∞—à –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç</div>
                </div>
            </div>
        </main>

        <!-- –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="bottom-nav">
            <button class="nav-btn" onclick="showMenuSection()">
                <span class="nav-icon">‚öôÔ∏è</span>
                <span class="nav-label">–ú–µ–Ω—é</span>
            </button>
            <button class="nav-btn" onclick="showInventorySection()">
                <span class="nav-icon">üéí</span>
                <span class="nav-label">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</span>
            </button>
            <button class="nav-btn active" onclick="showGamesSection()">
                <span class="nav-icon">üéÆ</span>
                <span class="nav-label">–ò–≥—Ä—ã</span>
            </button>
        </nav>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->

    <!-- –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞ (–∞–¥–º–∏–Ω) -->
    <div id="create-promo-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üéÅ –°–û–ó–î–ê–ù–ò–ï –ü–†–û–ú–û–ö–û–î–ê</h3>
                <button class="modal-close" onclick="closeCreatePromoModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="promo-create-form">
                    <div class="form-group">
                        <label>–ö–æ–¥ –ø—Ä–æ–º–æ–∫–æ–¥–∞:</label>
                        <input type="text" id="new-promo-code" class="admin-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä: WELCOME50)">
                    </div>
                    <div class="form-group">
                        <label>–ù–∞–≥—Ä–∞–¥–∞ (TON):</label>
                        <input type="number" id="new-promo-prize" class="admin-input" value="1" min="0.1" step="0.1">
                    </div>
                    <div class="form-group">
                        <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–∞—Ü–∏–π:</label>
                        <input type="number" id="new-promo-activations" class="admin-input" value="100" min="1" step="1">
                    </div>
                    <button class="modal-btn" onclick="createPromoCode()">üéÅ –°–û–ó–î–ê–¢–¨ –ü–†–û–ú–û–ö–û–î</button>
                    <div id="promo-create-result"></div>
                    
                    <div class="created-promos-list">
                        <h4>–°–æ–∑–¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã:</h4>
                        <div id="created-promos-container"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ (–∞–¥–º–∏–Ω) -->
    <div id="players-list-modal" class="modal-overlay">
        <div class="modal-content wide-modal">
            <div class="modal-header">
                <h3>üë• –°–ü–ò–°–û–ö –ò–ì–†–û–ö–û–í</h3>
                <button class="modal-close" onclick="closePlayersList()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="search-container">
                    <input type="text" id="player-search" class="search-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ ID, —é–∑–µ—Ä–Ω–µ–π–º—É –∏–ª–∏ –∫–æ—à–µ–ª—å–∫—É..." oninput="searchPlayers()">
                </div>
                <div class="players-list" id="players-list-container">
                    <!-- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>
    </div>

    <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à–∞–Ω—Å–∞–º–∏ (–∞–¥–º–∏–Ω) -->
    <div id="odds-control-modal" class="modal-overlay">
        <div class="modal-content wide-modal">
            <div class="modal-header">
                <h3>üé≤ –£–ü–†–ê–í–õ–ï–ù–ò–ï –®–ê–ù–°–ê–ú–ò</h3>
                <button class="modal-close" onclick="closeOddsControl()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="game-odds-selector">
                    <button class="game-odds-tab active" onclick="showGameOdds('dice')">–ö—É–±—ã</button>
                    <button class="game-odds-tab" onclick="showGameOdds('crash')">–ö—Ä–∞—à</button>
                </div>
                
                <div id="dice-odds-controls" class="odds-controls">
                    <div class="odds-control-item">
                        <div class="odds-control-label">–®–∞–Ω—Å –≤—ã–∏–≥—Ä—ã—à–∞ –ø—Ä–∏ —Å—Ç–∞–≤–∫–µ ‚â§1 TON:</div>
                        <input type="number" id="dice-win-chance-low" class="odds-control-input" value="50" min="1" max="100" step="1">%
                    </div>
                    <div class="odds-control-item">
                        <div class="odds-control-label">–®–∞–Ω—Å –≤—ã–∏–≥—Ä—ã—à–∞ –ø—Ä–∏ —Å—Ç–∞–≤–∫–µ >1 TON:</div>
                        <input type="number" id="dice-win-chance-high" class="odds-control-input" value="34" min="1" max="100" step="1">%
                    </div>
                    <div class="odds-control-item">
                        <div class="odds-control-label">–ú–Ω–æ–∂–∏—Ç–µ–ª—å 1 —á–∏—Å–ª–æ:</div>
                        <input type="number" id="dice-multiplier-single" class="odds-control-input" value="3" min="1" max="100" step="0.1">x
                    </div>
                    <div class="odds-control-item">
                        <div class="odds-control-label">–ú–Ω–æ–∂–∏—Ç–µ–ª—å 2 —á–∏—Å–ª–∞:</div>
                        <input type="number" id="dice-multiplier-double" class="odds-control-input" value="1.5" min="1" max="100" step="0.1">x
                    </div>
                    <div class="odds-control-item">
                        <div class="odds-control-label">–ú–Ω–æ–∂–∏—Ç–µ–ª—å 3 —á–∏—Å–ª–∞:</div>
                        <input type="number" id="dice-multiplier-triple" class="odds-control-input" value="1.25" min="1" max="100" step="0.1">x
                    </div>
                </div>
                
                <div id="crash-odds-controls" class="odds-controls hidden">
                    <div class="odds-control-item">
                        <div class="odds-control-label">–®–∞–Ω—Å 1.00x - 1.34x:</div>
                        <input type="number" id="crash-chance-134" class="odds-control-input" value="44.9" min="0.1" max="100" step="0.1">%
                    </div>
                    <div class="odds-control-item">
                        <div class="odds-control-label">–®–∞–Ω—Å 1.00x:</div>
                        <input type="number" id="crash-chance-100" class="odds-control-input" value="9" min="0.1" max="100" step="0.1">%
                    </div>
                    <div class="odds-control-item">
                        <div class="odds-control-label">–®–∞–Ω—Å 1.00x - 1.53x:</div>
                        <input type="number" id="crash-chance-153" class="odds-control-input" value="18" min="0.1" max="100" step="0.1">%
                    </div>
                    <div class="odds-control-item">
                        <div class="odds-control-label">–®–∞–Ω—Å 1.00x - 1.72x:</div>
                        <input type="number" id="crash-chance-172" class="odds-control-input" value="9" min="0.1" max="100" step="0.1">%
                    </div>
                    <div class="odds-control-item">
                        <div class="odds-control-label">–®–∞–Ω—Å 1.00x - 1.99x:</div>
                        <input type="number" id="crash-chance-199" class="odds-control-input" value="5" min="0.1" max="100" step="0.1">%
                    </div>
                    <div class="odds-control-item">
                        <div class="odds-control-label">–®–∞–Ω—Å 1.00x - 2.28x:</div>
                        <input type="number" id="crash-chance-228" class="odds-control-input" value="3" min="0.1" max="100" step="0.1">%
                    </div>
                    <div class="odds-control-item">
                        <div class="odds-control-label">–®–∞–Ω—Å 1.00x - 5.47x:</div>
                        <input type="number" id="crash-chance-547" class="odds-control-input" value="1.5" min="0.1" max="100" step="0.1">%
                    </div>
                    <div class="odds-control-item">
                        <div class="odds-control-label">–®–∞–Ω—Å 1.00x - 9.87x:</div>
                        <input type="number" id="crash-chance-987" class="odds-control-input" value="0.5" min="0.1" max="100" step="0.1">%
                    </div>
                    <div class="odds-control-item">
                        <div class="odds-control-label">–®–∞–Ω—Å 1.00x - 15.67x:</div>
                        <input type="number" id="crash-chance-1567" class="odds-control-input" value="0.1" min="0.01" max="100" step="0.01">%
                    </div>
                </div>
                
                <button class="modal-btn" onclick="saveOddsSettings()">üíæ –°–û–•–†–ê–ù–ò–¢–¨ –ù–ê–°–¢–†–û–ô–ö–ò</button>
                <div id="odds-save-result"></div>
            </div>
        </div>
    </div>

    <!-- –í—ã–≤–æ–¥—ã (–∞–¥–º–∏–Ω) -->
    <div id="withdraw-admin-modal" class="modal-overlay">
        <div class="modal-content wide-modal">
            <div class="modal-header">
                <h3>üí∞ –ó–ê–ü–†–û–°–´ –ù–ê –í–´–í–û–î</h3>
                <button class="modal-close" onclick="closeWithdrawAdmin()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="withdraw-admin-list" id="withdraw-admin-list">
                    <!-- –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –≤—ã–≤–æ–¥ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>
    </div>

    <div id="notification" class="notification">
        <div class="notification-content">
            <span id="notification-text"></span>
        </div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Supabase JS –±–∏–±–ª–∏–æ—Ç–µ–∫—É -->
    <script src="https://unpkg.com/@supabase/supabase-js@2.39.0/dist/umd/supabase.min.js"></script>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –Ω–∞—à –∞–¥–º–∏–Ω-–º–æ–¥—É–ª—å -->
    <script src="supabase-admin.js"></script>

    <script>
        // === –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ===
        let tg = window.Telegram?.WebApp;
        let appData = {
            balance: 0,
            userId: null,
            username: '–ì–æ—Å—Ç—å',
            isAdmin: false,
            walletConnected: false,
            walletAddress: null,
            diceGame: {
                betType: null,
                selectedNumbers: [],
                betAmount: 0.1,
                multiplier: 3,
                diceRolling: false
            },
            crashGame: {
                betAmount: 0.1,
                currentMultiplier: 1.00,
                gameActive: false,
                betPlaced: false,
                crashPoint: null,
                interval: null,
                duckPosition: 0,
                speed: 0.01,
                lastUpdate: Date.now(),
                lastMultiplier: 1.00
            },
            promoCodeDB: [],
            createdPromoCodes: [],
            withdrawRequests: [],
            maintenanceMode: false,
            telegramUser: null,
            depositCheckInterval: null,
            stats: {
                gamesPlayed: 0,
                totalTurnover: 0,
                maxWin: 0,
                frozenBalance: 0
            },
            oddsSettings: {
                dice: {
                    winChanceLow: 50,
                    winChanceHigh: 34,
                    multiplierSingle: 3,
                    multiplierDouble: 1.5,
                    multiplierTriple: 1.25
                },
                crash: {
                    chance134: 44.9,
                    chance100: 9,
                    chance153: 18,
                    chance172: 9,
                    chance199: 5,
                    chance228: 3,
                    chance547: 1.5,
                    chance987: 0.5,
                    chance1567: 0.1
                }
            }
        };

        // –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤
        let allPlayers = [];

        // === –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ===
        document.addEventListener('DOMContentLoaded', function() {
            initApp();
            updateUI();
            
            if (tg) {
                try {
                    tg.expand();
                    tg.enableClosingConfirmation();
                    tg.MainButton.setText('–ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª–µ–∫');
                    tg.MainButton.show();
                    tg.MainButton.onClick(connectWallet);
                    
                    appData.telegramUser = tg.initDataUnsafe?.user;
                    if (appData.telegramUser?.id === 921171528) {
                        appData.isAdmin = true;
                        localStorage.setItem('is_admin', 'true');
                        document.getElementById('admin-panel').classList.add('show');
                    }
                    
                    if (appData.telegramUser) {
                        appData.username = appData.telegramUser.username || appData.telegramUser.first_name || '–ì–æ—Å—Ç—å';
                    }
                } catch (e) {
                    console.log('Telegram Web App not available in browser');
                }
            }
            
            updateStats();
            loadOddsSettings();
        });

        function initApp() {
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            let userId = localStorage.getItem('user_id');
            if (!userId) {
                userId = 'USER_' + Math.floor(1000 + Math.random() * 9000);
                localStorage.setItem('user_id', userId);
                registerNewPlayer(userId);
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–ª–∞–Ω—Å–∞
            let balance = localStorage.getItem('balance');
            if (balance !== null) {
                appData.balance = parseFloat(balance);
            } else {
                appData.balance = 0;
                localStorage.setItem('balance', '0');
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤
            let frozenBalance = localStorage.getItem('frozen_balance');
            if (frozenBalance !== null) {
                appData.stats.frozenBalance = parseFloat(frozenBalance);
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            let stats = localStorage.getItem('user_stats');
            if (stats) {
                try {
                    appData.stats = JSON.parse(stats);
                } catch (e) {
                    appData.stats = { gamesPlayed: 0, totalTurnover: 0, maxWin: 0, frozenBalance: appData.stats.frozenBalance };
                }
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —é–∑–µ—Ä–Ω–µ–π–º–∞
            let savedUsername = localStorage.getItem('username');
            if (savedUsername) {
                appData.username = savedUsername;
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –∞–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞
            let savedWallet = localStorage.getItem('wallet_address');
            if (savedWallet) {
                appData.walletAddress = savedWallet;
                appData.walletConnected = true;
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –∞–¥–º–∏–Ω —Å—Ç–∞—Ç—É—Å–∞
            let adminStatus = localStorage.getItem('is_admin');
            appData.isAdmin = adminStatus === 'true' || appData.isAdmin;
            if (appData.isAdmin) {
                document.getElementById('admin-panel').classList.add('show');
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
            let savedPromos = localStorage.getItem('created_promos');
            if (savedPromos) {
                try {
                    appData.createdPromoCodes = JSON.parse(savedPromos);
                } catch (e) {
                    appData.createdPromoCodes = [];
                }
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–∑—ã –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
            let savedPromoDB = localStorage.getItem('promo_codes_db');
            if (savedPromoDB) {
                try {
                    appData.promoCodeDB = JSON.parse(savedPromoDB);
                } catch (e) {
                    appData.promoCodeDB = [];
                }
            } else {
                // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã
                appData.promoCodeDB = [
                    {
                        code: "WELCOME10",
                        prize: 10,
                        activations: 1000,
                        usedBy: []
                    },
                    {
                        code: "BONUS50",
                        prize: 50,
                        activations: 100,
                        usedBy: []
                    }
                ];
                localStorage.setItem('promo_codes_db', JSON.stringify(appData.promoCodeDB));
            }
            
            appData.userId = userId;
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–∑—ã –∏–≥—Ä–æ–∫–æ–≤
            loadAllPlayers();
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –≤—ã–≤–æ–¥
            loadWithdrawRequests();
            
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            document.getElementById('user-id').textContent = `ID: ${userId}`;
            document.getElementById('username').textContent = appData.username;
            document.getElementById('profile-id').textContent = userId;
            document.getElementById('profile-username').textContent = appData.username;
            document.getElementById('profile-wallet').textContent = appData.walletAddress || '–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω';
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
            let regDate = localStorage.getItem('reg_date');
            if (!regDate) {
                regDate = new Date().toLocaleDateString();
                localStorage.setItem('reg_date', regDate);
            }
            document.getElementById('reg-date').textContent = regDate;
            
            updatePlayerInDatabase();
        }

        // === –ë–ê–ó–ê –î–ê–ù–ù–´–• –ò–ì–†–û–ö–û–í ===
        function loadAllPlayers() {
            let players = localStorage.getItem('all_players');
            if (players) {
                try {
                    allPlayers = JSON.parse(players);
                } catch (e) {
                    allPlayers = [];
                }
            } else {
                allPlayers = [];
            }
        }

        function saveAllPlayers() {
            localStorage.setItem('all_players', JSON.stringify(allPlayers));
        }

        function registerNewPlayer(userId) {
            const newPlayer = {
                id: userId,
                username: appData.username,
                wallet: appData.walletAddress,
                balance: 0,
                turnover: 0,
                gamesPlayed: 0,
                maxWin: 0,
                registrationDate: new Date().toISOString(),
                lastActive: new Date().toISOString()
            };
            
            allPlayers.push(newPlayer);
            saveAllPlayers();
        }

        function updatePlayerInDatabase() {
            const playerIndex = allPlayers.findIndex(p => p.id === appData.userId);
            if (playerIndex !== -1) {
                allPlayers[playerIndex] = {
                    ...allPlayers[playerIndex],
                    username: appData.username,
                    wallet: appData.walletAddress,
                    balance: appData.balance,
                    turnover: appData.stats.totalTurnover,
                    gamesPlayed: appData.stats.gamesPlayed,
                    maxWin: appData.stats.maxWin,
                    lastActive: new Date().toISOString()
                };
                saveAllPlayers();
            }
        }

        // === –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê ===
        function updateUI() {
            // –ë–∞–ª–∞–Ω—Å
            const balanceElement = document.getElementById('balance');
            if (balanceElement) {
                balanceElement.textContent = appData.balance.toFixed(2);
            }
            
            // –Æ–∑–µ—Ä–Ω–µ–π–º –∏ ID –≤ —à–∞–ø–∫–µ
            document.getElementById('username').textContent = appData.username;
            document.getElementById('user-id').textContent = `ID: ${appData.userId}`;
            
            // –ö–æ—à–µ–ª–µ–∫
            const statusDot = document.getElementById('wallet-status-dot');
            const statusText = document.getElementById('wallet-status-text');
            const walletAddress = document.getElementById('wallet-address');
            const profileWallet = document.getElementById('profile-wallet');
            
            if (statusDot && statusText) {
                if (appData.walletConnected) {
                    statusDot.className = 'status-dot connected';
                    statusText.textContent = '–ü–æ–¥–∫–ª—é—á–µ–Ω';
                } else {
                    statusDot.className = 'status-dot';
                    statusText.textContent = '–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω';
                }
            }
            
            if (walletAddress) {
                walletAddress.textContent = appData.walletAddress || '–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫';
            }
            
            if (profileWallet) {
                profileWallet.textContent = appData.walletAddress || '–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω';
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –∏–≥—Ä—ã –≤ –∫–æ—Å—Ç–∏
            const playButton = document.getElementById('play-button');
            if (playButton) {
                const betType = appData.diceGame.betType;
                const numbers = appData.diceGame.selectedNumbers;
                const betAmount = appData.diceGame.betAmount;
                
                let requiredNumbers = 0;
                if (betType === 'single') requiredNumbers = 1;
                else if (betType === 'double') requiredNumbers = 2;
                else if (betType === 'triple') requiredNumbers = 3;
                
                const canPlay = betType && 
                              numbers.length === requiredNumbers && 
                              betAmount > 0 && 
                              betAmount <= appData.balance &&
                              !appData.diceGame.diceRolling;
                
                playButton.disabled = !canPlay;
                
                let potentialWin = 0;
                if (canPlay) {
                    potentialWin = betAmount * appData.diceGame.multiplier;
                }
                const potentialWinElement = document.getElementById('potential-win');
                if (potentialWinElement) {
                    potentialWinElement.textContent = `–í—ã–∏–≥—Ä—ã—à: ${potentialWin.toFixed(2)} TON`;
                }
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —á–∏—Å–µ–ª –≤ –∫–æ—Å—Ç—è—Ö
            const numberCircles = document.querySelectorAll('.number-circle');
            if (numberCircles.length > 0) {
                numberCircles.forEach(num => {
                    num.classList.remove('selected');
                });
                appData.diceGame.selectedNumbers.forEach(num => {
                    if (num >= 1 && num <= 6) {
                        const numElement = document.querySelectorAll('.number-circle')[num - 1];
                        if (numElement) numElement.classList.add('selected');
                    }
                });
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Å—Ç–∞–≤–∫–∏
            const betTypeCards = document.querySelectorAll('.bet-type-card');
            if (betTypeCards.length > 0) {
                betTypeCards.forEach(card => {
                    card.classList.remove('selected');
                });
                if (appData.diceGame.betType) {
                    const index = appData.diceGame.betType === 'single' ? 0 : 
                                 appData.diceGame.betType === 'double' ? 1 : 2;
                    if (betTypeCards[index]) {
                        betTypeCards[index].classList.add('selected');
                    }
                }
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É–º–º—ã —Å—Ç–∞–≤–∫–∏
            const diceBetAmount = document.getElementById('dice-bet-amount');
            if (diceBetAmount) {
                diceBetAmount.value = appData.diceGame.betAmount.toFixed(1);
            }
            
            const crashBetInput = document.getElementById('crash-bet-input');
            const crashBetSlider = document.getElementById('crash-bet-slider');
            if (crashBetInput && crashBetSlider) {
                crashBetInput.value = appData.crashGame.betAmount.toFixed(1);
                crashBetSlider.value = appData.crashGame.betAmount;
            }
            
            const betAmountDisplay = document.getElementById('bet-amount-display');
            if (betAmountDisplay) {
                betAmountDisplay.textContent = `${appData.crashGame.betAmount.toFixed(1)} TON`;
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–æ—Ä–∞ –∫—Ä–∞—à–∞
            const currentMultiplier = document.getElementById('current-multiplier');
            const cashoutMultiplier = document.getElementById('cashout-multiplier');
            if (currentMultiplier) {
                currentMultiplier.textContent = `${appData.crashGame.currentMultiplier.toFixed(2)}x`;
            }
            if (cashoutMultiplier) {
                cashoutMultiplier.textContent = `${appData.crashGame.currentMultiplier.toFixed(2)}x`;
            }
            
            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∞–º–∏ –∫—Ä–∞—à–∞
            const placeBetBtn = document.getElementById('place-bet-btn');
            const cashoutBtn = document.getElementById('cashout-btn');
            if (placeBetBtn && cashoutBtn) {
                if (appData.crashGame.gameActive && appData.crashGame.betPlaced) {
                    placeBetBtn.classList.add('hidden');
                    cashoutBtn.classList.remove('hidden');
                } else {
                    placeBetBtn.classList.remove('hidden');
                    cashoutBtn.classList.add('hidden');
                }
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Å—Ç–∞–≤–∫–∏ –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –≤—ã–∏–≥—Ä—ã—à–∞ –≤ –∫—Ä–∞—à–µ
            const currentBet = document.getElementById('current-bet');
            const potentialWinAmount = document.getElementById('potential-win-amount');
            if (currentBet && potentialWinAmount) {
                currentBet.textContent = `${appData.crashGame.betAmount.toFixed(2)} TON`;
                const winAmount = appData.crashGame.betAmount * appData.crashGame.currentMultiplier;
                potentialWinAmount.textContent = `${winAmount.toFixed(2)} TON`;
            }
            
            // –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
            const adminPanel = document.getElementById('admin-panel');
            if (adminPanel) {
                if (appData.isAdmin) {
                    adminPanel.classList.add('show');
                    const adminInput = document.getElementById('admin-code-input');
                    if (adminInput) {
                        adminInput.value = 'ttcg3d5';
                    }
                } else {
                    adminPanel.classList.remove('show');
                }
            }
            
            // –¢–µ—Ö—Ä–∞–±–æ—Ç—ã
            if (appData.maintenanceMode && (!appData.isAdmin || appData.telegramUser?.id !== 921171528)) {
                document.getElementById('app').classList.add('hidden');
                showMaintenanceScreen();
            } else {
                document.getElementById('app').classList.remove('hidden');
            }
            
            updatePlayerInDatabase();
        }

        function updateStats() {
            document.getElementById('games-played').textContent = appData.stats.gamesPlayed;
            document.getElementById('total-turnover').textContent = `${appData.stats.totalTurnover.toFixed(2)} TON`;
            document.getElementById('max-win').textContent = `${appData.stats.maxWin.toFixed(2)} TON`;
            
            localStorage.setItem('user_stats', JSON.stringify(appData.stats));
        }

        // === –ù–ê–í–ò–ì–ê–¶–ò–Ø ===
        function showGamesSection() {
            hideAllSections();
            document.getElementById('games-section').classList.add('active');
            setActiveNavButton(2);
            updateUI();
        }

        function showDiceGame() {
            hideAllSections();
            document.getElementById('dice-section').classList.add('active');
            setActiveNavButton(2);
            updateUI();
        }

        function showCrashGame() {
            hideAllSections();
            document.getElementById('crash-section').classList.add('active');
            setActiveNavButton(2);
            updateUI();
        }

        function showMenuSection() {
            hideAllSections();
            document.getElementById('menu-section').classList.add('active');
            setActiveNavButton(0);
            updateUI();
        }

        function showInventorySection() {
            hideAllSections();
            document.getElementById('inventory-section').classList.add('active');
            setActiveNavButton(1);
            updateUI();
        }

        function hideAllSections() {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
        }

        function setActiveNavButton(index) {
            document.querySelectorAll('.nav-btn').forEach((btn, i) => {
                btn.classList.toggle('active', i === index);
            });
        }

        // === –ò–ì–†–ê –í –ö–û–°–¢–ò ===
        function selectBetType(type) {
            appData.diceGame.betType = type;
            appData.diceGame.selectedNumbers = [];
            
            if (type === 'single') appData.diceGame.multiplier = appData.oddsSettings.dice.multiplierSingle;
            else if (type === 'double') appData.diceGame.multiplier = appData.oddsSettings.dice.multiplierDouble;
            else if (type === 'triple') appData.diceGame.multiplier = appData.oddsSettings.dice.multiplierTriple;
            
            const diceMultiplier = document.getElementById('dice-multiplier');
            if (diceMultiplier) {
                diceMultiplier.textContent = `${appData.diceGame.multiplier}x`;
            }
            
            updateUI();
        }

        function toggleNumber(number) {
            if (appData.diceGame.diceRolling) return;
            
            const index = appData.diceGame.selectedNumbers.indexOf(number);
            const maxNumbers = appData.diceGame.betType === 'single' ? 1 : 
                             appData.diceGame.betType === 'double' ? 2 : 3;
            
            if (index === -1) {
                if (appData.diceGame.selectedNumbers.length < maxNumbers) {
                    appData.diceGame.selectedNumbers.push(number);
                }
            } else {
                appData.diceGame.selectedNumbers.splice(index, 1);
            }
            updateUI();
        }

        function updateDiceBetAmount() {
            const amountInput = document.getElementById('dice-bet-amount');
            if (amountInput) {
                const amount = parseFloat(amountInput.value);
                if (!isNaN(amount) && amount >= 0.1) {
                    appData.diceGame.betAmount = amount;
                    updateUI();
                }
            }
        }

        function setQuickAmount(amount) {
            appData.diceGame.betAmount = amount;
            updateUI();
        }

        function startDiceGame() {
            if (appData.diceGame.betAmount > appData.balance) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!', 'error');
                return;
            }
            
            if (appData.diceGame.diceRolling) return;
            
            const requiredNumbers = appData.diceGame.betType === 'single' ? 1 : 
                                  appData.diceGame.betType === 'double' ? 2 : 3;
            
            if (appData.diceGame.selectedNumbers.length !== requiredNumbers) {
                showNotification(`–í—ã–±–µ—Ä–∏—Ç–µ ${requiredNumbers} —á–∏—Å–ª–∞`, 'error');
                return;
            }
            
            appData.balance -= appData.diceGame.betAmount;
            appData.stats.totalTurnover += appData.diceGame.betAmount;
            localStorage.setItem('balance', appData.balance.toString());
            appData.diceGame.diceRolling = true;
            
            const timer = document.getElementById('roll-timer');
            const timerText = timer.querySelector('.timer-text');
            const diceStatus = document.getElementById('dice-status');
            
            if (timer) timer.classList.remove('hidden');
            if (diceStatus) diceStatus.textContent = '–ö—Ä—É—Ç–∏–º...';
            
            let count = 3;
            if (timerText) timerText.textContent = count;
            
            const countdown = setInterval(() => {
                count--;
                if (timerText) timerText.textContent = count;
                
                if (count === 0) {
                    clearInterval(countdown);
                    if (timer) timer.classList.add('hidden');
                    rollDice();
                }
            }, 1000);
            
            updateUI();
            updateStats();
        }

        function rollDice() {
            const diceResult = document.getElementById('dice-result');
            const diceStatus = document.getElementById('dice-status');
            
            if (!diceResult || !diceStatus) return;
            
            diceResult.style.animation = 'none';
            setTimeout(() => {
                diceResult.style.animation = 'diceRoll 1s ease';
                
                let result;
                const betAmount = appData.diceGame.betAmount;
                
                const winChance = betAmount > 1 ? 
                    appData.oddsSettings.dice.winChanceHigh : 
                    appData.oddsSettings.dice.winChanceLow;
                
                const winProbability = winChance / 100;
                
                if (Math.random() < winProbability) {
                    result = appData.diceGame.selectedNumbers[Math.floor(Math.random() * appData.diceGame.selectedNumbers.length)];
                } else {
                    const allNumbers = [1, 2, 3, 4, 5, 6];
                    const possibleResults = allNumbers.filter(n => !appData.diceGame.selectedNumbers.includes(n));
                    result = possibleResults[Math.floor(Math.random() * possibleResults.length)];
                }
                
                diceResult.textContent = result;
                
                const isWin = appData.diceGame.selectedNumbers.includes(result);
                
                if (isWin) {
                    const winAmount = appData.diceGame.betAmount * appData.diceGame.multiplier;
                    appData.balance += winAmount;
                    
                    if (winAmount > appData.stats.maxWin) {
                        appData.stats.maxWin = winAmount;
                    }
                    
                    diceStatus.textContent = `–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${winAmount.toFixed(2)} TON!`;
                    showNotification(`üéâ –í—ã–∏–≥—Ä—ã—à ${winAmount.toFixed(2)} TON!`, 'success');
                    
                    appData.stats.gamesPlayed++;
                } else {
                    diceStatus.textContent = `–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏ ${appData.diceGame.betAmount.toFixed(2)} TON`;
                    showNotification(`üòî –ü—Ä–æ–∏–≥—Ä—ã—à ${appData.diceGame.betAmount.toFixed(2)} TON`, 'error');
                    appData.stats.gamesPlayed++;
                }
                
                localStorage.setItem('balance', appData.balance.toString());
                appData.diceGame.diceRolling = false;
                
                updateStats();
                
                setTimeout(() => {
                    appData.diceGame.selectedNumbers = [];
                    updateUI();
                }, 1000);
                
            }, 100);
        }

        // === –ò–ì–†–ê –ö–†–ê–® ===
        function updateCrashBetAmount() {
            const slider = document.getElementById('crash-bet-slider');
            const input = document.getElementById('crash-bet-input');
            if (slider && input) {
                const amount = parseFloat(slider.value);
                if (!isNaN(amount) && amount >= 0.1) {
                    appData.crashGame.betAmount = amount;
                    input.value = amount.toFixed(1);
                    updateUI();
                }
            }
        }

        function updateCrashBetInput() {
            const input = document.getElementById('crash-bet-input');
            const slider = document.getElementById('crash-bet-slider');
            if (input && slider) {
                const amount = parseFloat(input.value);
                if (!isNaN(amount) && amount >= 0.1 && amount <= 100) {
                    appData.crashGame.betAmount = amount;
                    slider.value = amount;
                    updateUI();
                }
            }
        }

        function setTargetMultiplier(multiplier) {
            showNotification(`–¶–µ–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞: ${multiplier}x`, 'info');
        }

        function placeCrashBet() {
            if (appData.crashGame.betAmount > appData.balance) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!', 'error');
                return;
            }
            
            if (appData.crashGame.gameActive) {
                showNotification('–ò–≥—Ä–∞ —É–∂–µ –∏–¥–µ—Ç!', 'error');
                return;
            }
            
            appData.balance -= appData.crashGame.betAmount;
            appData.stats.totalTurnover += appData.crashGame.betAmount;
            localStorage.setItem('balance', appData.balance.toString());
            
            appData.crashGame.gameActive = true;
            appData.crashGame.betPlaced = true;
            appData.crashGame.currentMultiplier = 1.00;
            appData.crashGame.duckPosition = 0;
            appData.crashGame.speed = 0.01;
            appData.crashGame.lastUpdate = Date.now();
            appData.crashGame.lastMultiplier = 1.00;
            
            generateCrashPoint();
            
            startCrashGame();
            updateUI();
            updateStats();
            showNotification('–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å!', 'info');
        }

        function generateCrashPoint() {
            const rand = Math.random() * 100;
            let crashPoint;
            
            if (rand < appData.oddsSettings.crash.chance100) {
                crashPoint = 1.00;
            } else if (rand < appData.oddsSettings.crash.chance100 + appData.oddsSettings.crash.chance134) {
                crashPoint = 1 + Math.random() * 0.34;
            } else if (rand < appData.oddsSettings.crash.chance100 + appData.oddsSettings.crash.chance134 + appData.oddsSettings.crash.chance153) {
                crashPoint = 1 + Math.random() * 0.53;
            } else if (rand < appData.oddsSettings.crash.chance100 + appData.oddsSettings.crash.chance134 + appData.oddsSettings.crash.chance153 + appData.oddsSettings.crash.chance172) {
                crashPoint = 1 + Math.random() * 0.72;
            } else if (rand < appData.oddsSettings.crash.chance100 + appData.oddsSettings.crash.chance134 + appData.oddsSettings.crash.chance153 + appData.oddsSettings.crash.chance172 + appData.oddsSettings.crash.chance199) {
                crashPoint = 1 + Math.random() * 0.99;
            } else if (rand < appData.oddsSettings.crash.chance100 + appData.oddsSettings.crash.chance134 + appData.oddsSettings.crash.chance153 + appData.oddsSettings.crash.chance172 + appData.oddsSettings.crash.chance199 + appData.oddsSettings.crash.chance228) {
                crashPoint = 1 + Math.random() * 1.28;
            } else if (rand < appData.oddsSettings.crash.chance100 + appData.oddsSettings.crash.chance134 + appData.oddsSettings.crash.chance153 + appData.oddsSettings.crash.chance172 + appData.oddsSettings.crash.chance199 + appData.oddsSettings.crash.chance228 + appData.oddsSettings.crash.chance547) {
                crashPoint = 1 + Math.random() * 4.47;
            } else if (rand < appData.oddsSettings.crash.chance100 + appData.oddsSettings.crash.chance134 + appData.oddsSettings.crash.chance153 + appData.oddsSettings.crash.chance172 + appData.oddsSettings.crash.chance199 + appData.oddsSettings.crash.chance228 + appData.oddsSettings.crash.chance547 + appData.oddsSettings.crash.chance987) {
                crashPoint = 1 + Math.random() * 8.87;
            } else {
                crashPoint = 1 + Math.random() * 14.67;
            }
            
            appData.crashGame.crashPoint = parseFloat(crashPoint.toFixed(2));
            console.log('Crash point generated:', appData.crashGame.crashPoint);
        }

        function startCrashGame() {
            const duckContainer = document.getElementById('duck-container');
            const progressBar = document.getElementById('multiplier-progress');
            const speedDisplay = document.getElementById('speed-display');
            
            if (speedDisplay) speedDisplay.classList.remove('hidden');
            
            if (appData.crashGame.interval) {
                clearInterval(appData.crashGame.interval);
            }
            
            appData.crashGame.interval = setInterval(() => {
                if (!appData.crashGame.gameActive) return;
                
                const now = Date.now();
                const deltaTime = (now - appData.crashGame.lastUpdate) / 1000;
                appData.crashGame.lastUpdate = now;
                
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
                if (appData.crashGame.currentMultiplier > 1.5) {
                    appData.crashGame.speed = 0.01 + (appData.crashGame.currentMultiplier - 1.5) * 0.002;
                }
                
                appData.crashGame.currentMultiplier += appData.crashGame.speed * deltaTime * 10;
                
                // –†–∞—Å—á–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ –Ω–∞–±–æ—Ä–∞
                const speedPerSec = (appData.crashGame.currentMultiplier - appData.crashGame.lastMultiplier) / deltaTime;
                appData.crashGame.lastMultiplier = appData.crashGame.currentMultiplier;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å –Ω–∞–±–æ—Ä–∞
                const speedValue = document.getElementById('speed-value');
                if (speedValue) {
                    speedValue.textContent = `${speedPerSec.toFixed(1)}x/—Å–µ–∫`;
                }
                
                // –î–≤–∏–∂–µ–Ω–∏–µ —É—Ç–∫–∏
                appData.crashGame.duckPosition += 0.5 + (appData.crashGame.speed * 20);
                const waveHeight = Math.sin(appData.crashGame.duckPosition * 0.1) * 20;
                
                if (duckContainer) {
                    duckContainer.style.left = `${20 + appData.crashGame.duckPosition}%`;
                    duckContainer.style.bottom = `${60 + waveHeight}px`;
                    
                    // –ê–Ω–∏–º–∞—Ü–∏—è —É—Ç–∫–∏ –Ω–∞ –≤–æ–ª–Ω–µ
                    const duckBody = duckContainer.querySelector('.duck-body');
                    if (duckBody) {
                        duckBody.style.transform = `translateY(${Math.sin(appData.crashGame.duckPosition * 0.2) * 5}px) rotate(${Math.sin(appData.crashGame.duckPosition * 0.1) * 5}deg)`;
                    }
                }
                
                if (progressBar && appData.crashGame.crashPoint) {
                    const progress = Math.min((appData.crashGame.currentMultiplier - 1) / (appData.crashGame.crashPoint - 1) * 100, 100);
                    progressBar.style.width = `${progress}%`;
                }
                
                if (appData.crashGame.currentMultiplier >= appData.crashGame.crashPoint) {
                    crashDuck();
                }
                
                updateUI();
            }, 50);
        }

        function cashOut() {
            if (!appData.crashGame.gameActive || !appData.crashGame.betPlaced) return;
            
            clearInterval(appData.crashGame.interval);
            
            const winAmount = appData.crashGame.betAmount * appData.crashGame.currentMultiplier;
            appData.balance += winAmount;
            localStorage.setItem('balance', appData.balance.toString());
            
            if (winAmount > appData.stats.maxWin) {
                appData.stats.maxWin = winAmount;
            }
            
            showNotification(`üéâ –í—ã –∑–∞–±—Ä–∞–ª–∏ ${winAmount.toFixed(2)} TON!`, 'success');
            
            addToHistory(appData.crashGame.currentMultiplier, true);
            
            appData.stats.gamesPlayed++;
            
            resetCrashGame();
            updateUI();
            updateStats();
        }

        function crashDuck() {
            clearInterval(appData.crashGame.interval);
            
            const duck = document.getElementById('duck');
            const speedDisplay = document.getElementById('speed-display');
            
            if (speedDisplay) speedDisplay.classList.add('hidden');
            
            if (duck) {
                duck.classList.add('crashed');
                
                setTimeout(() => {
                    duck.classList.remove('crashed');
                    
                    showNotification(`üí• –ö—Ä–∞—à –Ω–∞ ${appData.crashGame.currentMultiplier.toFixed(2)}x!`, 'error');
                    
                    addToHistory(appData.crashGame.currentMultiplier, false);
                    
                    appData.stats.gamesPlayed++;
                    
                    resetCrashGame();
                    updateUI();
                    updateStats();
                }, 1000);
            } else {
                resetCrashGame();
            }
        }

        function addToHistory(multiplier, isWin) {
            const historyList = document.getElementById('multiplier-history');
            if (!historyList) return;
            
            const historyItem = document.createElement('div');
            historyItem.className = `history-item ${isWin ? 'win' : 'loss'}`;
            historyItem.textContent = `${multiplier.toFixed(2)}x`;
            
            historyList.insertBefore(historyItem, historyList.firstChild);
            
            if (historyList.children.length > 5) {
                historyList.removeChild(historyList.lastChild);
            }
            
            const lastMultiplier = document.getElementById('last-multiplier');
            if (lastMultiplier) {
                lastMultiplier.textContent = `${multiplier.toFixed(2)}x`;
            }
        }

        function resetCrashGame() {
            appData.crashGame.gameActive = false;
            appData.crashGame.betPlaced = false;
            appData.crashGame.currentMultiplier = 1.00;
            appData.crashGame.crashPoint = null;
            appData.crashGame.duckPosition = 0;
            appData.crashGame.speed = 0.01;
            
            const duckContainer = document.getElementById('duck-container');
            const progressBar = document.getElementById('multiplier-progress');
            const speedDisplay = document.getElementById('speed-display');
            
            if (duckContainer) {
                duckContainer.style.left = '20%';
                duckContainer.style.bottom = '60px';
                
                const duckBody = duckContainer.querySelector('.duck-body');
                if (duckBody) {
                    duckBody.style.transform = 'none';
                }
            }
            
            if (progressBar) progressBar.style.width = '0%';
            if (speedDisplay) speedDisplay.classList.add('hidden');
            
            if (appData.crashGame.interval) {
                clearInterval(appData.crashGame.interval);
                appData.crashGame.interval = null;
            }
            
            updateUI();
        }

        // === –ö–û–®–ï–õ–ï–ö –ò –ü–õ–ê–¢–ï–ñ–ò ===
        function showWalletMenu() {
            document.getElementById('wallet-menu').classList.add('active');
        }

        function hideWalletMenu() {
            document.getElementById('wallet-menu').classList.remove('active');
        }

        function connectWallet() {
            // –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Wallet
            if (window.Telegram && window.Telegram.WebApp) {
                try {
                    window.Telegram.WebApp.openInvoice(
                        {
                            amount: '0', // –¢–µ—Å—Ç–æ–≤–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è
                            currency: 'TON',
                            description: '–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞'
                        },
                        function(status) {
                            if (status === 'paid') {
                                appData.walletConnected = true;
                                appData.walletAddress = 'UQAthS8QDwBDsbohkCxqfL22NS4NrtV9QMC1jBj78bb-4pVe';
                                
                                localStorage.setItem('wallet_address', appData.walletAddress);
                                
                                showNotification('–ö–æ—à–µ–ª–µ–∫ —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω!', 'success');
                                updateUI();
                                hideWalletMenu();
                            }
                        }
                    );
                } catch (e) {
                    // Fallback –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞
                    appData.walletConnected = true;
                    appData.walletAddress = 'UQAthS8QDwBDsbohkCxqfL22NS4NrtV9QMC1jBj78bb-4pVe';
                    
                    localStorage.setItem('wallet_address', appData.walletAddress);
                    
                    showNotification('–ö–æ—à–µ–ª–µ–∫ —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω!', 'success');
                    updateUI();
                    hideWalletMenu();
                }
            } else {
                // Fallback –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞
                appData.walletConnected = true;
                appData.walletAddress = 'UQAthS8QDwBDsbohkCxqfL22NS4NrtV9QMC1jBj78bb-4pVe';
                
                localStorage.setItem('wallet_address', appData.walletAddress);
                
                showNotification('–ö–æ—à–µ–ª–µ–∫ —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω!', 'success');
                updateUI();
                hideWalletMenu();
            }
        }

        function generateDeposit() {
            const amountInput = document.getElementById('deposit-amount');
            const depositInfo = document.getElementById('deposit-info');
            const depositAmount = document.getElementById('deposit-ton');
            
            if (!amountInput || !depositInfo || !depositAmount) return;
            
            const amount = parseFloat(amountInput.value);
            if (isNaN(amount) || amount < 0.1) {
                showNotification('–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ 0.1 TON', 'error');
                return;
            }
            
            depositAmount.textContent = amount.toFixed(2);
            depositInfo.classList.remove('hidden');
            
            // –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å TON —á–µ—Ä–µ–∑ Telegram Wallet
            if (window.Telegram && window.Telegram.WebApp && appData.walletConnected) {
                try {
                    window.Telegram.WebApp.openInvoice(
                        {
                            amount: (amount * 1000000000).toString(), // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ –Ω–∞–Ω–æ–¢–û–ù
                            currency: 'TON',
                            description: `–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –Ω–∞ ${amount} TON`
                        },
                        function(status) {
                            if (status === 'paid') {
                                appData.balance += amount;
                                localStorage.setItem('balance', appData.balance.toString());
                                updateUI();
                                showNotification(`‚úÖ –ë–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω –Ω–∞ ${amount} TON!`, 'success');
                                depositInfo.classList.add('hidden');
                            }
                        }
                    );
                } catch (e) {
                    // Fallback
                    copyDepositAddress();
                }
            } else {
                copyDepositAddress();
            }
        }

        function copyDepositAddress() {
            const address = 'UQAthS8QDwBDsbohkCxqfL22NS4NrtV9QMC1jBj78bb-4pVe';
            if (navigator.clipboard) {
                navigator.clipboard.writeText(address)
                    .then(() => showNotification('–ê–¥—Ä–µ—Å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!', 'success'))
                    .catch(() => fallbackCopy(address));
            } else {
                fallbackCopy(address);
            }
        }

        function fallbackCopy(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            showNotification('–ê–¥—Ä–µ—Å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!', 'success');
        }

        // === –ü–†–û–ú–û–ö–û–î–´ ===
        function activatePromoCode() {
            const codeInput = document.getElementById('promo-input');
            const resultDiv = document.getElementById('promo-result');
            
            if (!codeInput || !resultDiv) return;
            
            const code = codeInput.value.trim().toUpperCase();
            
            if (!code) {
                resultDiv.className = 'promo-result error';
                resultDiv.textContent = '–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥';
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±–∞–∑–µ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
            let promo = appData.promoCodeDB.find(p => p.code === code);
            if (!promo) {
                promo = appData.createdPromoCodes.find(p => p.code === code);
            }
            
            if (!promo) {
                resultDiv.className = 'promo-result error';
                resultDiv.textContent = '–¢–∞–∫–æ–≥–æ –ø—Ä–æ–º–æ–∫–æ–¥–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç';
                return;
            }
            
            if (promo.usedBy.includes(appData.userId)) {
                resultDiv.className = 'promo-result error';
                resultDiv.textContent = '–í—ã —É–∂–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª–∏ —ç—Ç–æ—Ç –ø—Ä–æ–º–æ–∫–æ–¥';
                return;
            }
            
            if (promo.activations <= 0) {
                resultDiv.className = 'promo-result error';
                resultDiv.textContent = '–ü—Ä–æ–º–æ–∫–æ–¥ –∏—Å—á–µ—Ä–ø–∞–Ω';
                return;
            }
            
            // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞
            promo.activations--;
            promo.usedBy.push(appData.userId);
            appData.balance += promo.prize;
            localStorage.setItem('balance', appData.balance.toString());
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –±–∞–∑—ã –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
            localStorage.setItem('promo_codes_db', JSON.stringify(appData.promoCodeDB));
            localStorage.setItem('created_promos', JSON.stringify(appData.createdPromoCodes));
            
            resultDiv.className = 'promo-result success';
            resultDiv.textContent = `–ü–æ–ª—É—á–µ–Ω–æ ${promo.prize} TON!`;
            
            codeInput.value = '';
            showNotification(`üéÅ –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –ø—Ä–æ–º–æ–∫–æ–¥ –Ω–∞ ${promo.prize} TON!`, 'success');
            updateUI();
            
            setTimeout(() => {
                resultDiv.className = 'promo-result';
                resultDiv.textContent = '';
            }, 3000);
        }

        // === –°–û–ó–î–ê–ù–ò–ï –ü–†–û–ú–û–ö–û–î–û–í (–ê–î–ú–ò–ù) ===
        function openCreatePromoModal() {
            if (!appData.isAdmin) return;
            
            const modal = document.getElementById('create-promo-modal');
            if (!modal) return;
            
            modal.classList.add('active');
            renderCreatedPromoCodes();
        }

        function closeCreatePromoModal() {
            document.getElementById('create-promo-modal').classList.remove('active');
        }

        function createPromoCode() {
            if (!appData.isAdmin) return;
            
            const codeInput = document.getElementById('new-promo-code');
            const prizeInput = document.getElementById('new-promo-prize');
            const activationsInput = document.getElementById('new-promo-activations');
            const resultDiv = document.getElementById('promo-create-result');
            
            if (!codeInput || !prizeInput || !activationsInput || !resultDiv) return;
            
            const code = codeInput.value.trim().toUpperCase();
            const prize = parseFloat(prizeInput.value);
            const activations = parseInt(activationsInput.value);
            
            if (!code || code.length < 4) {
                resultDiv.className = 'promo-result error';
                resultDiv.textContent = '–ö–æ–¥ –ø—Ä–æ–º–æ–∫–æ–¥–∞ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞';
                return;
            }
            
            if (isNaN(prize) || prize < 0.1) {
                resultDiv.className = 'promo-result error';
                resultDiv.textContent = '–ù–∞–≥—Ä–∞–¥–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 0.1 TON';
                return;
            }
            
            if (isNaN(activations) || activations < 1) {
                resultDiv.className = 'promo-result error';
                resultDiv.textContent = '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–∞—Ü–∏–π –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 1';
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø—Ä–æ–º–æ–∫–æ–¥
            const existingPromo = [...appData.promoCodeDB, ...appData.createdPromoCodes].find(p => p.code === code);
            if (existingPromo) {
                resultDiv.className = 'promo-result error';
                resultDiv.textContent = '–ü—Ä–æ–º–æ–∫–æ–¥ —Å —Ç–∞–∫–∏–º –∫–æ–¥–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç';
                return;
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–º–æ–∫–æ–¥–∞
            const newPromo = {
                code: code,
                prize: prize,
                activations: activations,
                usedBy: [],
                createdAt: new Date().toISOString(),
                createdBy: appData.userId
            };
            
            appData.createdPromoCodes.push(newPromo);
            localStorage.setItem('created_promos', JSON.stringify(appData.createdPromoCodes));
            
            resultDiv.className = 'promo-result success';
            resultDiv.textContent = `–ü—Ä–æ–º–æ–∫–æ–¥ ${code} —Å–æ–∑–¥–∞–Ω! –ù–∞–≥—Ä–∞–¥–∞: ${prize} TON, –∞–∫—Ç–∏–≤–∞—Ü–∏–π: ${activations}`;
            
            // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª–µ–π
            codeInput.value = '';
            prizeInput.value = '1';
            activationsInput.value = '100';
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
            renderCreatedPromoCodes();
            
            showNotification(`‚úÖ –ü—Ä–æ–º–æ–∫–æ–¥ ${code} —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!`, 'success');
        }

        function renderCreatedPromoCodes() {
            const container = document.getElementById('created-promos-container');
            if (!container) return;
            
            container.innerHTML = '';
            
            if (appData.createdPromoCodes.length === 0) {
                container.innerHTML = '<div class="promo-result">–ù–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤</div>';
                return;
            }
            
            appData.createdPromoCodes.forEach(promo => {
                const promoItem = document.createElement('div');
                promoItem.className = 'player-item';
                promoItem.innerHTML = `
                    <div class="player-info">
                        <div class="player-username"><strong>${promo.code}</strong></div>
                        <div class="player-id">–ù–∞–≥—Ä–∞–¥–∞: ${promo.prize} TON</div>
                        <div class="player-wallet">–ê–∫—Ç–∏–≤–∞—Ü–∏–π: ${promo.activations} | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ: ${promo.usedBy.length}</div>
                    </div>
                    <div class="player-balance">
                        <div class="balance-label">–°—Ç–∞—Ç—É—Å:</div>
                        <div class="balance-value">${promo.activations > 0 ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–ò—Å—á–µ—Ä–ø–∞–Ω'}</div>
                    </div>
                `;
                container.appendChild(promoItem);
            });
        }

        // === –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ ===
        function activateAdmin() {
            const codeInput = document.getElementById('admin-code-input');
            if (!codeInput) return;
            
            const code = codeInput.value.trim();
            
            if (code === 'ttcg3d5' || appData.isAdmin) {
                appData.isAdmin = true;
                localStorage.setItem('is_admin', 'true');
                const adminPanel = document.getElementById('admin-panel');
                if (adminPanel) {
                    adminPanel.classList.add('show');
                }
                showNotification('–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞!', 'success');
            } else {
                showNotification('–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥!', 'error');
            }
            updateUI();
        }

        // === –°–¢–ê–†–ê–Ø –§–£–ù–ö–¶–ò–Ø –û–ë–ù–£–õ–ò–¢–¨ –ë–ê–õ–ê–ù–° (—Å–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏) ===
        function resetAllBalances() {
            if (!appData.isAdmin) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤!', 'error');
                return;
            }
            
            if (!confirm('‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï!\n\n–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ–±–Ω—É–ª–∏—Ç—å –±–∞–ª–∞–Ω—Å –í–°–ï–ú –∏–≥—Ä–æ–∫–∞–º?\n\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!')) {
                return;
            }
            
            // –û–±–Ω—É–ª—è–µ–º –±–∞–ª–∞–Ω—Å –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
            allPlayers.forEach(player => {
                player.balance = 0;
                player.frozenBalance = 0;
            });
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é –±–∞–∑—É
            saveAllPlayers();
            
            // –ï—Å–ª–∏ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–¥–º–∏–Ω, –æ–±–Ω—É–ª—è–µ–º –∏ –µ–≥–æ –±–∞–ª–∞–Ω—Å —Ç–æ–∂–µ
            if (appData.userId !== 'USER_921171528') {
                appData.balance = 0;
                appData.stats.frozenBalance = 0;
                localStorage.setItem('balance', '0');
                localStorage.setItem('frozen_balance', '0');
                updateUI();
            }
            
            showNotification('‚úÖ –ë–∞–ª–∞–Ω—Å –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤ –æ–±–Ω—É–ª–µ–Ω!', 'success');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤, –µ—Å–ª–∏ –æ–Ω –æ—Ç–∫—Ä—ã—Ç
            if (document.getElementById('players-list-modal').classList.contains('active')) {
                renderPlayersList(document.getElementById('player-search').value);
            }
        }

        // –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ (–∞–¥–º–∏–Ω)
        function openPlayersList() {
            if (!appData.isAdmin) return;
            
            const modal = document.getElementById('players-list-modal');
            const container = document.getElementById('players-list-container');
            
            if (!modal || !container) return;
            
            renderPlayersList('');
            
            modal.classList.add('active');
        }

        function closePlayersList() {
            document.getElementById('players-list-modal').classList.remove('active');
        }

        function searchPlayers() {
            const searchInput = document.getElementById('player-search');
            if (!searchInput) return;
            
            const query = searchInput.value.toLowerCase();
            renderPlayersList(query);
        }

        function renderPlayersList(query) {
            const container = document.getElementById('players-list-container');
            if (!container) return;
            
            let filteredPlayers = allPlayers;
            
            if (query) {
                filteredPlayers = allPlayers.filter(player => 
                    player.id.toLowerCase().includes(query) ||
                    (player.username && player.username.toLowerCase().includes(query)) ||
                    (player.wallet && player.wallet.toLowerCase().includes(query))
                );
            }
            
            container.innerHTML = '';
            
            if (filteredPlayers.length === 0) {
                container.innerHTML = '<div class="player-item">–ò–≥—Ä–æ–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }
            
            filteredPlayers.forEach(player => {
                const item = document.createElement('div');
                item.className = 'player-item';
                item.innerHTML = `
                    <div class="player-info">
                        <div class="player-username">${player.username}</div>
                        <div class="player-id">${player.id}</div>
                        ${player.wallet ? `<div class="player-wallet" onclick="copyToClipboard(this)">${player.wallet}</div>` : ''}
                    </div>
                    <div class="player-balance">
                        <div class="balance-label">–ë–∞–ª–∞–Ω—Å:</div>
                        <div class="balance-value">${player.balance.toFixed(2)} TON</div>
                    </div>
                    <div class="balance-edit">
                        <input type="number" id="edit-balance-${player.id}" placeholder="–ù–æ–≤—ã–π –±–∞–ª–∞–Ω—Å" step="0.1">
                        <button onclick="updatePlayerBalance('${player.id}')">–ò–∑–º–µ–Ω–∏—Ç—å</button>
                    </div>
                `;
                container.appendChild(item);
            });
        }

        function updatePlayerBalance(playerId) {
            if (!appData.isAdmin) return;
            
            const input = document.getElementById(`edit-balance-${playerId}`);
            if (!input) return;
            
            const newBalance = parseFloat(input.value);
            if (isNaN(newBalance) || newBalance < 0) {
                showNotification('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Å—É–º–º–∞!', 'error');
                return;
            }
            
            const playerIndex = allPlayers.findIndex(p => p.id === playerId);
            if (playerIndex !== -1) {
                allPlayers[playerIndex].balance = newBalance;
                saveAllPlayers();
                
                if (playerId === appData.userId) {
                    appData.balance = newBalance;
                    localStorage.setItem('balance', newBalance.toString());
                    updateUI();
                }
                
                showNotification(`–ë–∞–ª–∞–Ω—Å –∏–≥—Ä–æ–∫–∞ ${playerId} –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ ${newBalance} TON`, 'success');
                input.value = '';
                
                renderPlayersList(document.getElementById('player-search').value);
            }
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à–∞–Ω—Å–∞–º–∏ (–∞–¥–º–∏–Ω)
        function openOddsControl() {
            if (!appData.isAdmin) return;
            
            const modal = document.getElementById('odds-control-modal');
            if (!modal) return;
            
            loadOddsSettingsToForm();
            
            modal.classList.add('active');
        }

        function closeOddsControl() {
            document.getElementById('odds-control-modal').classList.remove('active');
        }

        function showGameOdds(game) {
            document.querySelectorAll('.game-odds-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById('dice-odds-controls').classList.add('hidden');
            document.getElementById('crash-odds-controls').classList.add('hidden');
            
            if (game === 'dice') {
                document.querySelector('.game-odds-tab[onclick*="dice"]').classList.add('active');
                document.getElementById('dice-odds-controls').classList.remove('hidden');
            } else {
                document.querySelector('.game-odds-tab[onclick*="crash"]').classList.add('active');
                document.getElementById('crash-odds-controls').classList.remove('hidden');
            }
        }

        function loadOddsSettings() {
            let savedOdds = localStorage.getItem('odds_settings');
            if (savedOdds) {
                try {
                    appData.oddsSettings = JSON.parse(savedOdds);
                } catch (e) {
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                }
            }
        }

        function saveOddsSettings() {
            localStorage.setItem('odds_settings', JSON.stringify(appData.oddsSettings));
            showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —à–∞–Ω—Å–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
        }

        function loadOddsSettingsToForm() {
            document.getElementById('dice-win-chance-low').value = appData.oddsSettings.dice.winChanceLow;
            document.getElementById('dice-win-chance-high').value = appData.oddsSettings.dice.winChanceHigh;
            document.getElementById('dice-multiplier-single').value = appData.oddsSettings.dice.multiplierSingle;
            document.getElementById('dice-multiplier-double').value = appData.oddsSettings.dice.multiplierDouble;
            document.getElementById('dice-multiplier-triple').value = appData.oddsSettings.dice.multiplierTriple;
            
            document.getElementById('crash-chance-134').value = appData.oddsSettings.crash.chance134;
            document.getElementById('crash-chance-100').value = appData.oddsSettings.crash.chance100;
            document.getElementById('crash-chance-153').value = appData.oddsSettings.crash.chance153;
            document.getElementById('crash-chance-172').value = appData.oddsSettings.crash.chance172;
            document.getElementById('crash-chance-199').value = appData.oddsSettings.crash.chance199;
            document.getElementById('crash-chance-228').value = appData.oddsSettings.crash.chance228;
            document.getElementById('crash-chance-547').value = appData.oddsSettings.crash.chance547;
            document.getElementById('crash-chance-987').value = appData.oddsSettings.crash.chance987;
            document.getElementById('crash-chance-1567').value = appData.oddsSettings.crash.chance1567;
        }

        function saveOddsSettingsFromForm() {
            appData.oddsSettings.dice.winChanceLow = parseFloat(document.getElementById('dice-win-chance-low').value) || 50;
            appData.oddsSettings.dice.winChanceHigh = parseFloat(document.getElementById('dice-win-chance-high').value) || 34;
            appData.oddsSettings.dice.multiplierSingle = parseFloat(document.getElementById('dice-multiplier-single').value) || 3;
            appData.oddsSettings.dice.multiplierDouble = parseFloat(document.getElementById('dice-multiplier-double').value) || 1.5;
            appData.oddsSettings.dice.multiplierTriple = parseFloat(document.getElementById('dice-multiplier-triple').value) || 1.25;
            
            appData.oddsSettings.crash.chance134 = parseFloat(document.getElementById('crash-chance-134').value) || 44.9;
            appData.oddsSettings.crash.chance100 = parseFloat(document.getElementById('crash-chance-100').value) || 9;
            appData.oddsSettings.crash.chance153 = parseFloat(document.getElementById('crash-chance-153').value) || 18;
            appData.oddsSettings.crash.chance172 = parseFloat(document.getElementById('crash-chance-172').value) || 9;
            appData.oddsSettings.crash.chance199 = parseFloat(document.getElementById('crash-chance-199').value) || 5;
            appData.oddsSettings.crash.chance228 = parseFloat(document.getElementById('crash-chance-228').value) || 3;
            appData.oddsSettings.crash.chance547 = parseFloat(document.getElementById('crash-chance-547').value) || 1.5;
            appData.oddsSettings.crash.chance987 = parseFloat(document.getElementById('crash-chance-987').value) || 0.5;
            appData.oddsSettings.crash.chance1567 = parseFloat(document.getElementById('crash-chance-1567').value) || 0.1;
            
            saveOddsSettings();
        }

        // –í—ã–≤–æ–¥—ã (–∞–¥–º–∏–Ω)
        function openWithdrawRequestsAdmin() {
            if (!appData.isAdmin) return;
            
            const modal = document.getElementById('withdraw-admin-modal');
            const list = document.getElementById('withdraw-admin-list');
            
            if (!modal || !list) return;
            
            loadWithdrawRequests();
            renderWithdrawAdminList();
            
            modal.classList.add('active');
        }

        function closeWithdrawAdmin() {
            document.getElementById('withdraw-admin-modal').classList.remove('active');
        }

        function loadWithdrawRequests() {
            let requests = localStorage.getItem('withdraw_requests');
            if (requests) {
                try {
                    appData.withdrawRequests = JSON.parse(requests);
                } catch (e) {
                    appData.withdrawRequests = [];
                }
            } else {
                appData.withdrawRequests = [];
            }
        }

        function saveWithdrawRequests() {
            localStorage.setItem('withdraw_requests', JSON.stringify(appData.withdrawRequests));
        }

        function renderWithdrawAdminList() {
            const list = document.getElementById('withdraw-admin-list');
            if (!list) return;
            
            list.innerHTML = '';
            
            if (appData.withdrawRequests.length === 0) {
                list.innerHTML = '<div class="withdraw-admin-item">–ù–µ—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –≤—ã–≤–æ–¥</div>';
                return;
            }
            
            appData.withdrawRequests.forEach((request, index) => {
                const item = document.createElement('div');
                item.className = 'withdraw-admin-item';
                item.innerHTML = `
                    <div class="withdraw-user-info">
                        <div class="withdraw-username">${request.username}</div>
                        <div class="withdraw-user-id">${request.id}</div>
                    </div>
                    <div class="withdraw-wallet" onclick="copyToClipboard(this)">${request.walletAddress}</div>
                    <div class="withdraw-amount">
                        <div class="amount-label">–°—É–º–º–∞ –≤—ã–≤–æ–¥–∞:</div>
                        <div class="amount-value">${request.amount} TON</div>
                    </div>
                    <div class="withdraw-actions">
                        <button class="withdraw-action-btn withdraw-approve" onclick="approveWithdrawAdmin(${index})">‚úÖ –û–¥–æ–±—Ä–∏—Ç—å</button>
                        <button class="withdraw-action-btn withdraw-reject" onclick="rejectWithdrawAdmin(${index})">‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
                    </div>
                `;
                list.appendChild(item);
            });
        }

        function approveWithdrawAdmin(index) {
            if (!appData.isAdmin || index >= appData.withdrawRequests.length) return;
            
            const request = appData.withdrawRequests[index];
            
            appData.withdrawRequests.splice(index, 1);
            saveWithdrawRequests();
            
            renderWithdrawAdminList();
            
            showNotification(`–í—ã–≤–æ–¥ ${request.amount} TON –æ–¥–æ–±—Ä–µ–Ω –¥–ª—è ${request.username}`, 'success');
        }

        function rejectWithdrawAdmin(index) {
            if (!appData.isAdmin || index >= appData.withdrawRequests.length) return;
            
            const request = appData.withdrawRequests[index];
            
            const playerIndex = allPlayers.findIndex(p => p.id === request.id);
            if (playerIndex !== -1) {
                allPlayers[playerIndex].balance += request.amount;
                allPlayers[playerIndex].frozenBalance = (allPlayers[playerIndex].frozenBalance || 0) - request.amount;
                saveAllPlayers();
                
                if (request.id === appData.userId) {
                    appData.balance += request.amount;
                    appData.stats.frozenBalance -= request.amount;
                    localStorage.setItem('balance', appData.balance.toString());
                    localStorage.setItem('frozen_balance', appData.stats.frozenBalance.toString());
                    updateUI();
                    updateStats();
                }
            }
            
            appData.withdrawRequests.splice(index, 1);
            saveWithdrawRequests();
            
            renderWithdrawAdminList();
            
            showNotification(`–í—ã–≤–æ–¥ ${request.amount} TON –æ—Ç–∫–ª–æ–Ω–µ–Ω –¥–ª—è ${request.username}`, 'success');
        }

        // === –í–´–í–û–î –°–†–ï–î–°–¢–í ===
        function requestWithdrawal() {
            const amountInput = document.getElementById('withdraw-input');
            const resultDiv = document.getElementById('withdraw-result');
            
            if (!amountInput || !resultDiv) return;
            
            const amount = parseFloat(amountInput.value);
            
            if (isNaN(amount) || amount < 5) {
                resultDiv.className = 'withdraw-result error show';
                resultDiv.textContent = '–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –≤—ã–≤–æ–¥–∞ 5 TON';
                return;
            }
            
            if (amount > appData.balance) {
                resultDiv.className = 'withdraw-result error show';
                resultDiv.textContent = '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤';
                return;
            }
            
            if (!appData.walletConnected) {
                resultDiv.className = 'withdraw-result error show';
                resultDiv.textContent = '–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫';
                return;
            }
            
            appData.balance -= amount;
            appData.stats.frozenBalance += amount;
            localStorage.setItem('balance', appData.balance.toString());
            localStorage.setItem('frozen_balance', appData.stats.frozenBalance.toString());
            
            const request = {
                id: appData.userId,
                username: appData.username,
                amount: amount,
                walletAddress: appData.walletAddress,
                status: 'pending',
                date: new Date().toISOString()
            };
            
            appData.withdrawRequests.push(request);
            saveWithdrawRequests();
            
            resultDiv.className = 'withdraw-result pending show';
            resultDiv.textContent = '–ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–≤–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –æ–¥–æ–±—Ä–µ–Ω–∏–µ';
            
            amountInput.value = '5';
            showNotification('‚úÖ –ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–≤–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω', 'success');
            updateUI();
            updateStats();
            
            setTimeout(() => {
                resultDiv.className = 'withdraw-result';
                resultDiv.textContent = '';
            }, 5000);
        }

        // === –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –†–ê–ë–û–¢–´ ===
        function toggleMaintenance() {
            if (!appData.isAdmin) return;
            
            appData.maintenanceMode = !appData.maintenanceMode;
            const button = document.getElementById('toggle-maintenance-btn');
            
            if (button) {
                if (appData.maintenanceMode) {
                    button.textContent = 'üü¢ –í–∫–ª—é—á–∏—Ç—å';
                    showNotification('‚úÖ –ò–≥—Ä–∞ –≤—ã–∫–ª—é—á–µ–Ω–∞ –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π', 'success');
                } else {
                    button.textContent = 'üîß –í—ã–∫–ª—é—á–∏—Ç—å';
                    showNotification('‚úÖ –ò–≥—Ä–∞ –≤–∫–ª—é—á–µ–Ω–∞ –¥–ª—è –≤—Å–µ—Ö', 'success');
                }
            }
            
            updateUI();
        }

        function showMaintenanceScreen() {
            const existingOverlay = document.querySelector('.maintenance-overlay');
            if (existingOverlay) {
                existingOverlay.remove();
            }
            
            const overlay = document.createElement('div');
            overlay.className = 'modal-overlay active';
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: var(--darker-bg);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 9999;
            `;
            
            overlay.innerHTML = `
                <div class="modal-content" style="text-align: center;">
                    <div class="modal-header">
                        <h3>üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –†–ê–ë–û–¢–´</h3>
                    </div>
                    <div class="modal-body">
                        <div style="font-size: 60px; margin: 20px 0;">üîß</div>
                        <h2 style="color: var(--primary-green); margin-bottom: 20px;">–ò–ì–†–ê –ù–ê –¢–ï–• –†–ê–ë–û–¢–ê–•</h2>
                        <p style="color: var(--text-secondary); margin-bottom: 10px;">–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ.</p>
                        <p style="color: var(--text-secondary);">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.</p>
                    </div>
                </div>
            `;
            
            document.body.appendChild(overlay);
        }

        // === –£–¢–ò–õ–ò–¢–´ ===
        function showNotification(text, type) {
            const notification = document.getElementById('notification');
            const textElement = document.getElementById('notification-text');
            
            if (!notification || !textElement) return;
            
            textElement.textContent = text;
            notification.className = `notification ${type}`;
            notification.classList.add('active');
            
            setTimeout(() => {
                notification.classList.remove('active');
            }, 3000);
        }

        function copyToClipboard(element) {
            if (!element) return;
            
            const text = element.textContent;
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text)
                    .then(() => showNotification('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!', 'success'))
                    .catch(() => fallbackCopy(text));
            } else {
                fallbackCopy(text);
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        window.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal-overlay')) {
                e.target.classList.remove('active');
            }
        });
    </script>
</body>
</html>
